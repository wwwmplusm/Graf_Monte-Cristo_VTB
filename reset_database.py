#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
–£–¥–∞–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∞–π–ª –ë–î –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é —á–∏—Å—Ç—É—é –±–∞–∑—É.
"""

import os
import sys
from pathlib import Path

# Add hktn to path
sys.path.insert(0, str(Path(__file__).parent))

from hktn.core.database import DB_FILE, init_db


def reset_database():
    """–£–¥–∞–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ë–î –∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é."""
    db_path = Path(DB_FILE)
    
    # –£–¥–∞–ª—è–µ–º —Ñ–∞–π–ª –ë–î, –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    if db_path.exists():
        print(f"üóëÔ∏è  –£–¥–∞–ª—è—é —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: {db_path.absolute()}")
        db_path.unlink()
        print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–¥–∞–ª–µ–Ω–∞")
    else:
        print(f"‚ÑπÔ∏è  –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω: {db_path.absolute()}")
    
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –ë–î
    print("üîß –°–æ–∑–¥–∞—é –Ω–æ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å —á–∏—Å—Ç–æ–π —Å—Ö–µ–º–æ–π...")
    init_db()
    print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!")
    print(f"üìÅ –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: {db_path.absolute()}")
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
    if db_path.exists():
        size_kb = db_path.stat().st_size / 1024
        print(f"üìä –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: {size_kb:.2f} KB")


if __name__ == "__main__":
    print("=" * 60)
    print("üîÑ –°–ë–†–û–° –ë–ê–ó–´ –î–ê–ù–ù–´–•")
    print("=" * 60)
    
    # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±—Ä–æ—Å–∞)
    response = input("\n‚ö†Ô∏è  –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ! –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å? (yes/no): ")
    if response.lower() not in ['yes', 'y', '–¥–∞']:
        print("‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ")
        sys.exit(0)
    
    print()
    reset_database()
    print("\n" + "=" * 60)
    print("‚ú® –ì–æ—Ç–æ–≤–æ! –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–±—Ä–æ—à–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.")
    print("=" * 60)

