# Cash Predict

## Обзор проекта

- **Цель:** помочь пользователям принимать уверенные финансовые решения: собрать данные банковских счетов, рассчитать безопасный остаток для расходов и показать весомые рекомендации на легковесной панели.
- **Стек:** FastAPI на Python для сбора данных, аналитики и API + прототип фронтенда на TypeScript/Vite, пока работающий на моках.
- **Статус:** ядро бэкенда (согласия, сбор, аналитика) уже работает через переиспользуемые клиенты OBR; фронтенд пока демонстрируется через отрисованный и анимированный прототип.

## Основные возможности

1. **Согласия и агрегация** — инициируем согласия в песочнице, опрашиваем статус и скачиваем счета/транзакции через `core.obr_client`.
2. **Аналитическая платформа** — превращает необработанные транзакции в обязательства, цели и сценарии (см. `data/scripts/test_anal.py` и `hktn/core/analytics_engine.py`).
3. **Backend API** — FastAPI-роутеры экспонируют банки, конвейер согласий, onboarding и дашборд; покрыты минимальными проверками и снуп-тестом.
4. **Инструменты данных** — хелперы вроде `collect_data.py`/`hndmd.py` автоматизируют сбор данных из песочницы для демо и презентаций.

## Analytics Engine

- **Что делает:** преобразует поток транзакций в набор обязательств, прогнозов по платежам и безопасного остатка на день. Использует сценарное моделирование (симуляции) для оценки распределения будущих расходов и рассчитывает safe-to-spend, опираясь на текущий баланс, доходы и критические платежи.
- **Ключевые компоненты:**
  - `core.analytics_engine.run_analysis_with_details` — строит прогноз, возвращает траектории, профили событий и шумов.
  - `core.analytics_engine.build_financial_portrait` — соединяет транзакции, кредиты и счета, чтобы выделить цели пользователя и ранжировать стрессы по кредитам.
  - `core.analytics_engine.calculate_safe_to_spend` — агрегирует обязательства и симуляции, выдаёт безопасную сумму к расходам.
- **Демо-оболочка:** `data/scripts/test_anal.py` демонстрирует, как собрать данные и вывести выводы по safe-to-spend, траекториям и профилю риска; скрипт служит заготовкой для будущей визуализации.

## Фронтенд и демо

- Мы подготовили **полный прототип во Figma**, который описывает путь пользователя, визуальную стилистику и сценарии для презентаций и демонстраций. 
- Мыптью подвязать конечные точки бэкенда к продвинутому интерфейсу, но моковое поведение соответствует тому, как мы проектируем API.
- Мы продолжаем работу над бэкендом и планируем закончить интеграцию к полуфиналу; сейчас демо проходит по подготовленным данным и прототипу, чтобы показать всю идею.

## Быстрый старт

```bash
python -m venv venv
source venv/bin/activate
pip install -r hktn/requirements.txt
cd hktn
npx vite build
```

Точка входа бэкенда: `python -m hktn.backend.app` (FastAPI + Uvicorn).

## Следующие шаги

- Завершить интеграцию между FastAPI и интерфейсом из прототипа.
- Расширить автоматические тесты (смоук, аналитика, интеграции) и подключить CI.
