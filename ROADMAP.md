# 🗺️ FinPulse Roadmap - Визуальный план

---

## 📊 Общий прогресс: 70% → 95%

```
Текущее состояние:     ████████████████░░░░░░░░░░░░ 70%
После доработки:        ████████████████████████████ 95%

Осталось работы:        18-26 часов
```

---

## 🎯 Матрица функционала

| Модуль | Статус | Готовность | Критичность | Время |
|--------|--------|------------|-------------|-------|
| **Backend Core** | ✅ Работает | 90% | ✅ OK | - |
| **OpenBanking Integration** | ✅ Работает | 95% | ✅ OK | - |
| **Алгоритмы (1-6)** | ✅ Работают | 100% | ✅ OK | - |
| **Алгоритмы (7-9)** | ❌ Отсутствуют | 0% | 🔴 HIGH | 8 ч |
| **Онбординг Flow** | ⚠️ Частично | 70% | 🔴 HIGH | 6 ч |
| **Dashboard API** | ✅ Работает | 95% | ✅ OK | - |
| **Payments API** | ✅ Работает | 100% | ✅ OK | - |
| **Refinance API** | ❌ Отсутствует | 0% | 🔴 HIGH | 8 ч |
| **Loans API** | ❌ Отсутствует | 0% | 🔴 HIGH | 3 ч |
| **Deposits API** | ❌ Отсутствует | 0% | 🔴 HIGH | 3 ч |
| **Profile API** | ❌ Отсутствует | 0% | 🟡 LOW | 3 ч |
| **UI/UX** | ✅ Работает | 90% | ✅ OK | - |
| **Database** | ✅ Работает | 100% | ✅ OK | - |

---

## 🔥 Критический путь (20 часов)

### Задача 1: Онбординг (6 часов)
```
Файлы:
  Backend:  hktn/backend/services/consents.py
  Frontend: hktn/src/components/steps/Step2ConsentProgress.tsx

Этапы:
  1.1.1 [ ] Backend - auto-approve check           (2 ч)
  1.1.2 [ ] Backend - polling endpoint             (1 ч)
  1.1.3 [ ] Frontend - ссылка + polling            (3 ч)

Результат:
  ✅ Онбординг соответствует спецификации
  ✅ Пользователь видит ссылку на банк
  ✅ Polling обновляет статус каждые 5 сек
```

### Задача 2: Refinancing API (8 часов)
```
Файлы:
  Backend:  hktn/backend/services/algorithms.py
           hktn/backend/routers/refinance.py (создать)
  Frontend: hktn/src/screens/RefinanceScreen.tsx

Этапы:
  1.2.1 [ ] Алгоритм financing_need_detector()     (2 ч)
  1.2.2 [ ] Алгоритм best_financing_offer_selector (3 ч)
  1.2.3 [ ] Backend роутер /api/refinance/*        (2 ч)
  1.2.4 [ ] Frontend интеграция                    (1 ч)

Результат:
  ✅ Реальные офферы рефинансирования
  ✅ Расчет выгоды и экономии
  ✅ Консолидация кредитов
  ✅ DTI и триггеры
```

### Задача 3: Loans/Deposits API (6 часов)
```
Файлы:
  Backend:  hktn/backend/routers/loans.py (создать)
  Frontend: hktn/src/screens/LoansDetailScreen.tsx
           hktn/src/screens/DepositsDetailScreen.tsx

Этапы:
  1.3.1 [ ] Backend - парсинг кредитов/вкладов     (3 ч)
  1.3.2 [ ] Frontend интеграция                    (3 ч)

Результат:
  ✅ Реальный список кредитов из банков
  ✅ Реальный список вкладов
  ✅ Priority ранжирование
  ✅ Детали по каждому продукту
```

---

## 🟠 Важные улучшения (6 часов)

### Задача 4: Goal Selection валидация (2 часа)
```
[ ] Frontend: проверка наличия кредитов через API
[ ] Frontend: блокировка кнопки если нет кредитов
[ ] Frontend: tooltip с объяснением
```

### Задача 5: Repayment Speed (1 час)
```
[ ] Frontend: отправка repayment_speed в API
[ ] Backend: сохранение в БД
[ ] Backend: использование в adp_calculation()
```

### Задача 6: Health Reasons (2 часа)
```
[ ] Backend: генерация списка reasons[]
[ ] Backend: добавление в _calculate_health_score()
[ ] Frontend: отображение в Health Widget
```

---

## 🎨 Визуальная карта экранов

```
┌─────────────────────────────────────────────────────────────┐
│                      SPLASH SCREEN                          │
│                                                              │
│                    [FinPulse Logo]                          │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                   ONBOARDING (7 steps)                       │
│                                                              │
│  Step 1: User Info          [ team260-X ]                   │
│  Step 2: Banks & Consents   [✓] VBank [✓] ABank            │
│  Step 3: Consent Progress   ⏳ Ожидание...  [Подтвердить→] │  ← ДОРАБОТАТЬ
│  Step 5: Goal Selection     [Закрыть долги] [Накопить]     │  ← ДОРАБОТАТЬ
│  Step 6: Summary            ✓ Всё готово                    │
│  Step 7: Loading            Анализируем...                  │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                      HOME SCREEN                             │
│                                                              │
│  Header:  [Привет, User!]              [🔄 Обновить]       │
│                                                              │
│  Widgets:                                                    │
│    📊 Health Score        [72 - спокойно]       ✅          │
│    💰 STS Today          [12,500₽ осталось]    ✅          │
│    🏦 Loans Summary      [450,000₽ долг]       ✅          │
│       ├─ MDP [850₽]     [Оплатить]            ✅          │
│       └─ ADP [1,200₽]   [Оплатить]            ✅          │
│    📅 Upcoming Events    [3 события]           ✅          │
│    💳 Debit Cards        [85,000₽]             ✅          │
│                                                              │
│  Bottom Nav: [Home] [Loans] [Refinance] [Profile]          │
└─────────────────────┬───────────────────────────────────────┘
                      │
        ┌─────────────┼─────────────┬─────────────┐
        ▼             ▼             ▼             ▼
  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
  │  LOANS   │  │REFINANCE │  │ DEPOSITS │  │ PROFILE  │
  │  DETAIL  │  │  SCREEN  │  │  DETAIL  │  │  SCREEN  │
  │          │  │          │  │          │  │          │
  │ ⚠️ MOCK   │  │ ⚠️ MOCK   │  │ ⚠️ MOCK   │  │ ❌ НЕТ   │
  └──────────┘  └──────────┘  └──────────┘  └──────────┘
      ↓              ↓              ↓              ↓
   ДОРАБОТАТЬ    ДОРАБОТАТЬ    ДОРАБОТАТЬ    ОПЦИОНАЛЬНО
```

---

## 📈 Прогресс по дням

### День 1: Онбординг + валидация (8 часов)
```
08:00 ─────────┐
               │ Задача 1.1.1: Backend auto-approve (2 ч)
10:00 ─────────┤
               │ Задача 1.1.2: Backend polling (1 ч)
11:00 ─────────┤
               │ Перерыв (1 ч)
12:00 ─────────┤
               │ Задача 1.1.3: Frontend ссылка + polling (3 ч)
15:00 ─────────┤
               │ Задача 4: Goal Selection валидация (2 ч)
16:00 ─────────┘

Результат: ✅ Онбординг по спецификации
           ✅ Goal Selection валидация
```

### День 2: Refinancing (8 часов)
```
08:00 ─────────┐
               │ Задача 1.2.1: financing_need_detector (2 ч)
10:00 ─────────┤
               │ Задача 1.2.2: best_financing_offer_selector (3 ч)
13:00 ─────────┤
               │ Перерыв (1 ч)
14:00 ─────────┤
               │ Задача 1.2.3: Backend роутер (2 ч)
16:00 ─────────┤
               │ Задача 1.2.4: Frontend интеграция (1 ч)
16:00 ─────────┘

Результат: ✅ Refinancing Engine работает
           ✅ Реальные офферы
           ✅ Консолидация кредитов
```

### День 3: Loans/Deposits + полировка (8 часов)
```
08:00 ─────────┐
               │ Задача 1.3.1: Backend парсинг (3 ч)
11:00 ─────────┤
               │ Задача 1.3.2: Frontend интеграция (3 ч)
14:00 ─────────┤
               │ Задача 5: Repayment Speed (1 ч)
15:00 ─────────┤
               │ Задача 6: Health Reasons (2 ч)
16:00 ─────────┘

Результат: ✅ Loans/Deposits Detail с реальными данными
           ✅ Repayment Speed работает
           ✅ Health Score с reasons
```

---

## 🎯 Метрики успеха

### Текущее состояние (70%)
```
✅ Backend API:           17/20 endpoints   (85%)
✅ Алгоритмы:             6/9 реализовано   (67%)
✅ UI Screens:            8/9 экранов       (89%)
⚠️ Онбординг:             4/6 шагов корректно (67%)
❌ Refinancing:           0% готовности
❌ Loans/Deposits Detail: Mock данные
```

### После доработки (95%)
```
✅ Backend API:           20/20 endpoints   (100%)
✅ Алгоритмы:             9/9 реализовано   (100%)
✅ UI Screens:            8/9 экранов       (89%)
✅ Онбординг:             6/6 шагов корректно (100%)
✅ Refinancing:           100% готовности
✅ Loans/Deposits Detail: Реальные данные
```

---

## 🚀 Демонстрация на хакатоне

### Сценарий 1: "Мультибанк с реальными данными" (3 мин)
```
1. Онбординг:
   - Ввести team260-3
   - Выбрать VBank + ABank
   - Подключить все согласия (accounts, products, payments)
   - [Показать ссылку на банк для подтверждения] ← НОВОЕ
   - Выбрать цель "Закрыть кредиты"

2. Dashboard:
   - Показать Health Score (72 - спокойно)
   - Показать STS (12,500₽ можно потратить сегодня)
   - Показать Loans Summary (450,000₽ долг)
   - Показать Upcoming Events (платеж через 5 дней)

3. Акцент на реальность:
   - "Это реальные данные из банков через OpenBanking API"
   - "Обновление каждые 15 минут"
   - "Кеширование для быстродействия"
```

### Сценарий 2: "Умные платежи MDP/ADP" (2 мин)
```
1. Loans Detail:
   - Показать список всех кредитов ← НОВОЕ (реальные данные)
   - Показать MDP (850₽) и ADP (1,200₽)
   - Объяснить Avalanche стратегию

2. Совершить платеж:
   - Нажать "Оплатить MDP"
   - Выбрать счет списания
   - Подтвердить
   - [Показать успешную транзакцию]

3. Акцент на автоматизацию:
   - "MDP рассчитывается автоматически каждый день"
   - "ADP адаптируется под ваш доход"
   - "Стратегия Avalanche минимизирует переплату"
```

### Сценарий 3: "Refinancing Engine" (3 мин)
```
1. Refinance Screen:
   - Показать список офферов ← НОВОЕ (реальные расчеты)
   - Показать экономию (45,000₽ за год)
   - Показать срок окупаемости (2 месяца)

2. Подать заявку:
   - Выбрать лучший оффер
   - Нажать "Подать заявку"
   - [Показать одобрение/отклонение]

3. Акцент на value:
   - "Автоматический подбор лучших условий"
   - "Реальные офферы из product catalog"
   - "DTI и триггеры определяют срочность"
```

### Killer Features для жюри:
1. **Реальная интеграция** - не mock, а настоящие банковские API
2. **6 сложных алгоритмов** - STS, MDP, ADP, Categorization, Debt, Balance
3. **Умное кеширование** - быстрая загрузка без спама на банки
4. **Refinancing Engine** - уникальная фича автоподбора ← НОВОЕ
5. **Единый dashboard** - все банки в одном месте

---

## 📋 Чеклист перед демо

### За день до хакатона:
- [ ] Все критичные задачи завершены (20 ч)
- [ ] Онбординг работает по спецификации
- [ ] Refinancing возвращает реальные офферы
- [ ] Loans/Deposits Detail показывают реальные данные
- [ ] Backend деплоится без ошибок
- [ ] Frontend билдится без warnings
- [ ] База данных с тестовыми данными team260-3

### Утром в день хакатона:
- [ ] Запустить backend (uvicorn)
- [ ] Запустить frontend (vite)
- [ ] Проверить все 3 сценария демо
- [ ] Убедиться что банки отвечают
- [ ] Подготовить резервный вариант (mock fallback)

### Перед выходом на сцену:
- [ ] Открыть приложение в браузере
- [ ] Пройти онбординг для team260-3
- [ ] Убедиться что dashboard загружен
- [ ] Закрыть все лишние вкладки
- [ ] Увеличить zoom в браузере (125%)

---

## 🎓 Полезные ссылки

### Документация:
- `context/back onboard.md` - **Библия проекта** (спецификация)
- `IMPLEMENTATION_ANALYSIS.md` - Что реализовано (600 строк)
- `DEVELOPMENT_PLAN.md` - Что делать (1000 строк с кодом)
- `QUICK_SUMMARY.md` - Краткое резюме (5 минут чтения)
- `DATA_FLOW_AND_CALCULATIONS.md` - Как работают расчеты

### API Endpoints:
- Dashboard: `GET /api/dashboard?user_id=team260-3`
- Consents: `POST /api/consent/initiate`
- Payments: `POST /api/payments/mdp`
- Refinance: `GET /api/refinance/optimize-loans` ← НОВОЕ
- Loans: `GET /api/loans?user_id=team260-3` ← НОВОЕ

### Тестовые данные:
- User ID: `team260-3`
- Banks: VBank, ABank, SBank
- Product Catalog: `hktn/team260_data/products/catalog.json`
- Sample Accounts: `hktn/team260_data/accounts/`
- Sample Agreements: `hktn/team260_data/agreements/`

---

## 💡 Советы команде

### Для Backend разработчика:
1. Начинай с `consents.py` - это критично
2. Потом `algorithms.py` - добавь алгоритмы 7-9
3. Затем `loans.py` - создай новый роутер
4. Тестируй через curl или Postman
5. Логируй всё через logger.info()

### Для Frontend разработчика:
1. Начинай с `Step2ConsentProgress.tsx`
2. Потом `RefinanceScreen.tsx`
3. Затем `LoansDetailScreen.tsx`
4. Используй TypeScript интерфейсы
5. Тестируй через Chrome DevTools

### Для тестировщика:
1. Проверь User Flow из спецификации
2. Убедись что все endpoints отвечают
3. Протестируй все 3 сценария демо
4. Проверь edge cases (нет кредитов, нет денег)
5. Подготовь fallback plan

---

## 🏆 Успех!

**После завершения всех задач:**
- ✅ 95% готовности
- ✅ Соответствие спецификации
- ✅ Реальная работа с банками
- ✅ Killer features демонстрируемы
- ✅ Готовность к хакатону

**FinPulse - мультибанковый финансовый ассистент нового поколения! 🚀**

