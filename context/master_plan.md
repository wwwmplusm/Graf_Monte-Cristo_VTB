# Master Plan: Пошаговая реализация FinPulse

Поскольку вы работаете с унаследованным кодом и хотите иметь возможность проверять каждый шаг, мы будем использовать стратегию **"Вертикальных срезов"**.

Вместо того чтобы писать весь бэкенд, а потом весь фронтенд, мы будем реализовывать **одну функцию за раз** от начала до конца (Бэкенд + Фронтенд + Тест). Это позволит вам всегда иметь работающее приложение.

---

## Фаза 1: Фундамент (Пользователь и Профиль)
**Цель:** Приложение запускается, можно "войти" (даже фиктивно) и увидеть свой профиль.

### Шаг 1.1: Бэкенд - Аутентификация и Профиль
- [ ] Создать `routers/auth.py`: добавить эндпоинт `POST /api/auth/login` (возвращает токен и user_id).
- [ ] Обновить [routers/profile.py](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/backend/routers/profile.py): добавить `GET /api/profile` (возвращает имя, тариф, статус).
- [ ] **Проверка:** Вызвать через Swagger (http://localhost:8000/docs) `/api/auth/login`, получить ответ.

### Шаг 1.2: Фронтенд - Навигация и Вход
- [ ] Создать структуру навигации (Bottom Navigation) в [App.tsx](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/src/App.tsx).
- [ ] Обновить `UserIdPage` (экран входа) чтобы он стучался в новый `POST /api/auth/login`.
- [ ] Создать пустую страницу `ProfilePage` и подключить её в навигацию.
- [ ] **Проверка:** Запустить фронт, ввести "demo-user", попасть на пустой экран профиля.

---

## Фаза 2: Подключение Банков (Data Ingestion)
**Цель:** Пользователь может выбрать банк, пройти флоу согласия, и мы увидим эти данные в базе.

### Шаг 2.1: Бэкенд - Исправление путей
- [ ] Привести [routers/consents.py](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/backend/routers/consents.py) и [routers/banks.py](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/backend/routers/banks.py) в соответствие с документацией (пути `/api/banks`, `/api/onboarding/consents`).
- [ ] **Проверка:** Swagger -> `GET /api/banks` возвращает список.

### Шаг 2.2: Фронтенд - Каталог банков
- [ ] Обновить `BanksCatalogPage` чтобы он брал данные с правильного API.
- [ ] Проверить переход на `ConsentProcessPage`.
- [ ] **Проверка:** В приложении выбрать банк, нажать "Подключить", увидеть лог успеха в консоли браузера.

---

## Фаза 3: Главный экран (Dashboard & STS)
**Цель:** Показать пользователю, сколько денег он может потратить (Safe-to-Spend).

### Шаг 3.1: Бэкенд - Аналитика
- [ ] Доработать [routers/analytics.py](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/backend/routers/analytics.py): убедиться, что `GET /api/dashboard` возвращает `sts_today` и `days_until_next_income`.
- [ ] **Проверка:** Swagger -> `GET /api/dashboard` возвращает JSON с цифрами.

### Шаг 3.2: Фронтенд - Виджет STS
- [ ] Обновить [DashboardPage](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/src/pages/DashboardPage.tsx#47-98): красиво отобразить цифру STS.
- [ ] Добавить виджет "Счета" (простой список карт).
- [ ] **Проверка:** На главном экране видна большая цифра "Можно потратить".

---

## Фаза 4: Кредиты и Платежи (Самое сложное)
**Цель:** Показать список кредитов, рассчитать обязательный платеж (MDP) и дать возможность "оплатить".

### Шаг 4.1: Бэкенд - Логика платежей
- [ ] Создать сервис `services/payments_logic.py`: функции расчета MDP (сколько отложить сегодня).
- [ ] Обновить [routers/analytics.py](file:///home/kesha/MyCode/HACKATHON/CASH_PREDICT/hktn/backend/routers/analytics.py): включить MDP в ответ дашборда.
- [ ] Создать `routers/payments.py`: эндпоинт `POST /api/payments/plan` (виртуальная оплата).

### Шаг 4.2: Фронтенд - Экран Кредитов
- [ ] Создать `LoansPage` (вкладка "Долги").
- [ ] Отобразить список кредитов.
- [ ] Сделать кнопку "Оплатить MDP", которая вызывает `POST /api/payments/plan`.
- [ ] **Проверка:** Нажать кнопку -> цифра долга уменьшилась (визуально), STS пересчитался.

---

## Фаза 5: Рефинансирование (Финал)
**Цель:** Предложить пользователю более выгодный кредит.

### Шаг 5.1: Бэкенд - Офферы
- [ ] Создать `routers/refinance.py`: логика подбора офферов.

### Шаг 5.2: Фронтенд - Экран Рефинансирования
- [ ] Создать `RefinancePage`.
- [ ] Отобразить "Вы можете сэкономить X рублей".

---

## Как мы будем работать?
Я буду вести вас по этому плану. Мы берем **Шаг 1.1**, я пишу код, вы (или я) запускаете и проверяем. Если работает — идем к **Шагу 1.2**.
