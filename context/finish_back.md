# –ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–¥—É–∫—Ç–∞

## 1. –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞ —Ä—ã–Ω–∫–µ

–†–æ—Å—Å–∏–π—Å–∫–∏–π —Ä—ã–Ω–æ–∫ –∫ 2025 –≥–æ–¥—É —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è —Ç—Ä–µ–º—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è–º–∏:

### 1.1. –§—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç —Å—á–µ—Ç–∞, –∫–∞—Ä—Ç—ã, –∫—Ä–µ–¥–∏—Ç—ã –∏ –¥–µ–ø–æ–∑–∏—Ç—ã –≤ 2‚Äì4 –±–∞–Ω–∫–∞—Ö. –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç:

- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –µ–¥–∏–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω—ã –∞–∫—Ç–∏–≤–æ–≤, –¥–æ–ª–≥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤;
- –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏;
- –æ—à–∏–±–∫–∏ –≤ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞;
- –Ω–∏–∑–∫—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã –º–µ–∂–¥—É –±–∞–Ω–∫–∞–º–∏;
- –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏.

–≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç—Ä–∞–∂–µ–Ω–∞ –≤ –º–∞—Ç–µ—Ä–∏–∞–ª–∞—Ö —Ö–∞–∫–∞—Ç–æ–Ω–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ–±—è–∑–∞–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ—Å—è—Ç–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, —á—Ç–æ –º–µ—à–∞–µ—Ç –ø—Ä–∏–Ω—è—Ç–∏—é —Ä–µ—à–µ–Ω–∏–π –∏ —Å–Ω–∏–∂–∞–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –º–µ–∂–¥—É –±–∞–Ω–∫–∞–º–∏.

### 1.2. –†–æ—Å—Ç –¥–æ–ª–≥–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è

- 50 –º–ª–Ω –∑–∞–µ–º—â–∏–∫–æ–≤, –¥–æ–ª–≥ 34,6 —Ç—Ä–ª–Ω —Ä—É–±.
- 22% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–º–µ—é—Ç –ü–î–ù >50%.
- –ü—Ä–æ–±–ª–µ–º–Ω–∞—è –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å = 2,2 —Ç—Ä–ª–Ω —Ä—É–±., —Ä–æ—Å—Ç –≤ 1,5 —Ä–∞–∑–∞ –∑–∞ –≥–æ–¥.
- –ì—Ä—É–ø–ø–∞ 25‚Äì35 –ª–µ—Ç ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∏—Å–∫–æ–≤–∞–Ω–Ω–∞—è: >58% –∏–º–µ–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –≤—ã–ø–ª–∞—Ç–∞–º–∏.
:contentReference[oaicite:1]{index=1}

–¢–µ–∑–∏—Å: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–µ–Ω –Ω–µ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∞ **–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º –∑–¥–æ—Ä–æ–≤—å–µ–º**, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç —Ä–∏—Å–∫–∏, –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞, –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Å–Ω–∏–∂–µ–Ω–∏—è –¥–æ–ª–≥–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.

### 1.3. –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–π —Å–¥–≤–∏–≥ –≤ —Å—Ç–æ—Ä–æ–Ω—É –æ—Ç–∫—Ä—ã—Ç—ã—Ö API

–¶–ë –≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö 2025‚Äì2027 –ø—Ä—è–º–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç:

- —Ä–∞–∑–≤–∏—Ç–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö API;
- —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å, —É–¥–∞–ª—ë–Ω–Ω–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –∫–æ–Ω—Å–µ–Ω—Ç-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞;
- —É—Å–∏–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏ –∑–∞ —Å—á—ë—Ç –º–µ–∂–±–∞–Ω–∫–æ–≤—Å–∫–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö.

–§–∞–∫—Ç–∏—á–µ—Å–∫–∏, —Ä—ã–Ω–æ–∫ –≥–æ—Ç–æ–≤ –∫ –º—É–ª—å—Ç–∏–±–∞–Ω–∫—É ‚Äî –æ–Ω –∑–∞–ª–æ–∂–µ–Ω —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–º.

---

## 2. –¶–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 2.1. –ì–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (JTBD)

**¬´–•–æ—á—É –≤–∏–¥–µ—Ç—å –≤–µ—Å—å —Å–≤–æ–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –º–∏—Ä –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ –∏ –∏–º–µ—Ç—å –ø–ª–∞–Ω, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª–∏—Ç –º–Ω–µ –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫, –¥–æ–ª–≥–∞ –∏–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–∏¬ª**

:contentReference[oaicite:3]{index=3}

### 2.2. –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –±–æ–ª–∏:

- –ù–µ –≤–∏–¥–∏—Ç –ø–æ–ª–Ω—É—é –∫–∞—Ä—Ç–∏–Ω—É –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏.
- –ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç, –∫–∞–∫–æ–π –∫—Ä–µ–¥–∏—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–µ—Ä–≤—ã–º –∏ –≤ –∫–∞–∫–æ–π –º–æ–º–µ–Ω—Ç.
- –ù–µ –∑–Ω–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è (Safe-to-Spend).
- –ù–µ –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –¥–ª—è —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è.
- –ù–µ –≤–∏–¥–∏—Ç –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–∞—à–µ–Ω–∏–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–ø–∏—Å–∞–Ω–∏–π, –ø–æ–¥–ø–∏—Å–æ–∫.
- –ù–µ –ø–æ–Ω–∏–º–∞–µ—Ç, –≥–¥–µ –∏ —Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–ø–ª–∞—á–∏–≤–∞–µ—Ç.

### 2.3. –ú—ã —Ä–µ—à–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏:

1. **–°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö –±–∞–Ω–∫–æ–≤** ‚Üí —Å—á–µ—Ç–∞, –∫–∞—Ä—Ç—ã, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∫—Ä–µ–¥–∏—Ç—ã, –¥–µ–ø–æ–∑–∏—Ç—ã.
2. **–§—É–Ω–∫—Ü–∏—è Safe-to-Spend** ‚Äî —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è –±–µ–∑ —Ä–∏—Å–∫–∞.
3. **–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–æ–ª–≥–∞**:
    - –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫—Ä–µ–¥–∏—Ç–æ–≤;
    - –ø–ª–∞–Ω –∑–∞–∫—Ä—ã—Ç–∏—è (snowball, avalanche, hybrid);
    - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏/ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
4. **–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è** ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∞ —Ç–∞–º, –≥–¥–µ —ç–∫–æ–Ω–æ–º–∏—è > X‚ÇΩ.
5. **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –≤–∫–ª–∞–¥–∞–º –∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ–¥—É–∫—Ç–∞–º** ‚Äî –µ—Å–ª–∏ —Ü–µ–ª—å ¬´–Ω–∞–∫–æ–ø–∏—Ç—å¬ª.

---

---

## 4. –ë–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å

### 4.1. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ö–æ–¥–∞

**1. –ü–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏–µ CPA/CPS**

–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Ä—ã–Ω–æ—á–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫:

- –∫–∞—Ä—Ç—ã: 1 080‚Äì5 250 —Ä—É–±–ª–µ–π –∑–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—é;
- –∫—Ä–µ–¥–∏—Ç—ã: 3 000‚Äì22 500 —Ä—É–±–ª–µ–π –∑–∞ –≤—ã–¥–∞—á—É;
- —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ: 400‚Äì4 551 —Ä—É–±–ª–µ–π;
1. –ü–æ–¥–ø–∏—Å–∫–∏

### 4.2. –ü—Ä–∏–Ω—Ü–∏–ø –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

–ú—ã –º–æ–Ω–µ—Ç–∏–∑–∏—Ä—É–µ–º **—Ç–æ–ª—å–∫–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π –∏–Ω—Ç–µ–Ω—Ç**, –∫–æ—Ç–æ—Ä—ã–π —Å–∏—Å—Ç–µ–º–∞ –≤—ã—è–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ:

- –ø–∞–¥–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è;
- —Å–æ–±—ã—Ç–∏–π –≤ –±–ª–∏–∂–∞–π—à–∏–µ 7‚Äì30 –¥–Ω–µ–π;
- –∞–≤—Ç–æ–ø–ª–∞—Ç–µ–∂–µ–π
- —Ä–æ—Å—Ç–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ —Ä–∏—Å–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–∫–∏;
- —Å–≤–æ–±–æ–¥–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤.

–¢—Ä–∏–≥–≥–µ—Ä–Ω–∞—è –º–æ–¥–µ–ª—å ‚Üí –≤—ã—Å–æ–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è, –Ω–∏–∑–∫–∏–π CAC, –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –±–∞–Ω–∫–æ–≤.

–ü–æ–¥–ø–∏—Å–∫–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

---

## 6. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –ò–ò-–º–æ–¥–µ–ª–µ–π)

### 6.1. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ (–ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º—É –ø–ª–∞–Ω—É)

- backend: FastAPI (Python) ‚Üí –º–æ–Ω–æ–ª–∏—Ç;
- frontend: –º–æ–±–∏–ª—å–Ω—ã–π web-UI/SPA;
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: OpenBanking Russia v2.1;
- –¥–∞–Ω–Ω—ã–µ: —Å—á–µ—Ç–∞, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –¥–æ–≥–æ–≤–æ—Ä—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤;
- consent-flow: /account-consents;
- –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: OAuth2, JWT RS256, JWKS.

### 6.2. –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏

- OBR API client;
- Consent manager;
- Accounts/Transactions collector;
- Event discovery (DBSCAN + TFIDF);
- Forecast engine (Monte-Carlo);
- Credit optimizer;
- STS engine;
- Product recommender;
- Lead-generation module;
- Minimal DB (SQLite or in-memory).

### 6.3. –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

- –ë–∞–ª–∞–Ω—Å—ã;
- –ü–æ–ª–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è 12 –º–µ—Å.;
- –ö—Ä–µ–¥–∏—Ç–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã (+ —Å—Ç–∞–≤–∫–∏, –æ—Å—Ç–∞—Ç–∫–∏, –≥—Ä–∞—Ñ–∏–∫–∏);
- –ü—Ä–æ–¥—É–∫—Ç—ã –±–∞–Ω–∫–æ–≤ (product catalog);
- –ö–æ–º–∏—Å—Å–∏–∏ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º.

# User Flow: –æ—Ç –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ –¥–æ –∫–ª—é—á–µ–≤—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

## –õ–µ–≥–µ–Ω–¥–∞ —Å—Ç–æ–ª–±—Ü–æ–≤

- **Step ID** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —à–∞–≥ (–¥–ª—è —Å—Å—ã–ª–æ–∫ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏).
- **Screen / Tab** ‚Äî –∫–∞–∫–æ–π —ç–∫—Ä–∞–Ω –∏–ª–∏ –≤–∫–ª–∞–¥–∫–∞ –Ω–∏–∂–Ω–µ–≥–æ –º–µ–Ω—é.
- **User action** ‚Äî —á—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–µ–ª–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.
- **Frontend behavior** ‚Äî –∫–∞–∫–∏–µ —ç–∫—Ä–∞–Ω—ã/—Å–æ—Å—Ç–æ—è–Ω–∏—è/–Ω–∞–≤–∏–≥–∞—Ü–∏—è.
- **Backend / Analytics** ‚Äî –∫–∞–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å.
- **State update** ‚Äî –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –Ω–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ.

---

## 1. –û–Ω–±–æ—Ä–¥–∏–Ω–≥, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∞–Ω–∫–æ–≤ –∏ –≤—ã–±–æ—Ä —Ü–µ–ª–∏

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| **1.2** | **Onboarding ‚Äî Sign-in** | –í–≤–æ–¥–∏—Ç –∏–º—è `demo-XXX` –∏ –∂–º—ë—Ç ¬´–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å¬ª | –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º—É –Ω–∞ –±—ç–∫–µ–Ω–¥. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ –±–∞–Ω–∫–æ–≤ + —Å–æ–≥–ª–∞—Å–∏–π. | `POST /api/auth/login`<br>–°–æ–∑–¥–∞–µ—Ç/–Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã–¥–∞–µ—Ç JWT. | `user_id`, `user_name`, `user_profile` |
| **1.3** | **Onboarding ‚Äî Banks + Consents matrix** | –í–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –±–∞–Ω–∫–æ–≤ (VBank, ABank, SBank). –û—Ç–º–µ—á–∞–µ—Ç –≥–∞–ª–æ—á–∫–æ–π –Ω—É–∂–Ω—ã–µ –±–∞–Ω–∫–∏. –ü–æ–¥ –∫–∞–∂–¥—ã–º –±–∞–Ω–∫–æ–º ‚Äî —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è –±–ª–æ–∫ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —Å–æ–≥–ª–∞—Å–∏—è–º–∏: <br>‚Ä¢ —á—Ç–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤/–±–∞–ª–∞–Ω—Å–æ–≤/—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π <br>‚Ä¢ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞–º–∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ <br>‚Ä¢ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π | UI: <br>‚Ä¢ —Å–ø–∏—Å–æ–∫ –±–∞–Ω–∫–æ–≤ —Å —á–µ–∫–±–æ–∫—Å–∞–º–∏; <br>‚Ä¢ –ø–æ–¥ –∫–∞–∂–¥—ã–º –±–∞–Ω–∫–æ–º —Å–ø–∏—Å–æ–∫ –∏–∑ –≤—Å–µ—Ö —Ç—Ä–µ—Ö —Å–æ–≥–ª–∞—Å–∏–π —Å—Ä–∞–∑—É, –±–µ–∑ —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–µ–≥–æ—Å—è —Å–ø–∏—Å–∫–∞<br> ‚Äì Read Accounts / Balances / Transactions <br> ‚Äì Product Agreements (read / open / close) <br> –°–æ–≥–ª–∞—Å–∏–µ –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π –≤—Å–µ—Ö –≤–∏–¥–æ–≤ –æ—Ç –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞ (–∏ single –∏ multiple –∏ VRP)< br>‚Ä¢ –í—Å–µ —Å–æ–≥–ª–∞—Å–∏—è –∏–º–µ—é—Ç —Å–≤–æ–∏ —á–µ–∫–±–æ–∫—Å—ã. <br>‚Ä¢ –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å¬ª –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–∞–Ω–∫ –≤—ã–±—Ä–∞–Ω –∏ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≥–ª–∞—Å–∏—è –≤–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ –æ—Ç–º–µ—á–µ–Ω—ã.
<br>–ò–Ω–∞—á–µ –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–π—Ç–∏ –¥–∞–ª—å—à–µ | `GET /api/banks`<br>–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±–∞–Ω–∫–æ–≤. | `selected_banks[]`, `selected_consents[{bank_id: {account:bool, product:bool, payment:bool}}]` |
|  |  |  |  |  |  |
| **1.5** | **Consent processing / progress** | –ñ–¥—ë—Ç, –ø–æ–∫–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ | –ò–∑ —Å–ø–∏—Å–∫–∞ –±–∞–Ω–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–±—Ä–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –±—ç–∫—ç–Ω–¥–µ –∑–∞–ø—Ä–æ—Å –Ω–∞ –∫–æ–Ω—Å–µ–Ω—Ç, –±–∞–Ω–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º –æ–∂–∏–¥–∞–Ω–∏—è. –ò –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª approve –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞, —Ç–æ –≤—ã–≤–æ–¥–∏—Ç—Å—è —ç–∫—Ä–∞–Ω—á–∏–∫ –æ–∂–∏–¥–∞–Ω–∏—è —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ –±–∞–Ω–∫, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –∏ –≤—Ä—É—á–Ω—É—é –≤—Å–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–∞–ª —Å–æ–≥–ª–∞—Å–∏–µ –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –≤—Å–µ, –Ω–∞ —á—Ç–æ –Ω–∞–¥–æ –¥–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ, —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ —ç–∫—Ä–∞–Ω—á–∏–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –±–∞–Ω–∫—É –∏–∑ —Å–ø–∏—Å–∫–∞. –ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –≤—Å–µ –±–∞–Ω–∫–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å, –±–∞–Ω–∫ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø—Ä–æ—Å–∞ –æ —Ü–µ–ª—è—Ö. | `POST /api/onboarding/consents`<br>–ò–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–∏–π (OpenBanking API).<br>`GET /api/onboarding/status` (polling)<br>–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–∞–Ω–∫–æ–≤. | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ `consents[]` —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ `approved/failed`. |
| **1.6** | **Onboarding ‚Äî Goal** | –í—ã–±–∏—Ä–∞–µ—Ç —Ü–µ–ª—å: ¬´–ó–∞–∫—Ä—ã—Ç—å –∫—Ä–µ–¥–∏—Ç—ã¬ª –∏–ª–∏ ¬´–ù–∞–∫–æ–ø–∏—Ç—å –Ω–∞ —Ü–µ–ª—å¬ª

!!! –ö–ù–û–ü–ö–ê –ó–ê–ö–†–´–¢–¨ –ö–†–ï–î–ò–¢–´ –î–û–°–¢–£–ü–ù–ê –¢–û–õ–¨–ö–û –ï–°–õ–ò –£ –ß–ï–õ–û–í–ï–ö–ê –ï–°–¢–¨ –ö–†–ï–î–ò–¢–´ / –ö–†–ï–î–ò–¢–ù–´–ï –ö–ê–†–¢–´ 

!! | UI ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–≤—É—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å¬ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞. | `POST /api/onboarding/goal`<br>–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (debt/savings). | `user_mode = "debt"` –∏–ª–∏ `"savings"` |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
| **1.9** | **Onboarding ‚Äî Summary** | –ñ–º—ë—Ç ¬´–ì–æ—Ç–æ–≤–æ¬ª | UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: <br>‚úì –±–∞–Ω–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã <br>‚úì —Å–æ–≥–ª–∞—Å–∏—è –≤—ã–¥–∞–Ω—ã <br>‚úì —Ü–µ–ª—å –≤—ã–±—Ä–∞–Ω–∞ <br>‚úì —Å–∫–æ—Ä–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ | `POST /api/onboarding/finalize`<br>–ó–∞–ø—É—Å–∫–∞–µ—Ç `SyncService` (—Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö) –∏ `AnalyticsService` (–ø–µ—Ä–≤–∏—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç). | `analysis_status = "running"` |
| **1.10** | **Loading ‚Üí Home** | –ü—Ä–æ—Å—Ç–æ –∂–¥—ë—Ç | UI: ¬´–ú—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–∞—à–∏ —Ñ–∏–Ω–∞–Ω—Å—ã‚Ä¶¬ª + –ø—Ä–æ–≥—Ä–µ—Å—Å. <br>–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Home. | `GET /api/onboarding/status`<br>–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞. | `accounts[]`, `transactions[]`, `agreements[]`, `events[]`, `sts_today`, `loan_summary`/`savings_summary`, –ø–ª–∞–Ω—ã, —Ç—Ä–∏–≥–≥–µ—Ä—ã |

---

## 2. –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (Home) –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è

Home ‚Äî —Å–≤–æ–¥–∫–∞: STS, Loans/Deposits, –±–ª–∏–∂–∞–π—à–∏–µ —Å–æ–±—ã—Ç–∏—è, —Ç—Ä–∏–≥–≥–µ—Ä—ã —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∞.

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| 2.1 | Home | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥) | Home –∫–∞–∫ –ø–µ—Ä–≤—ã–π —Ç–∞–±. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:<br>‚Ä¢ STS widget<br>‚Ä¢ Loans/Deposits widget (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `user_mode`), –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—Ä–∞–∑—É –≤–∏–¥–Ω—ã —Å—É–º–º—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ (–¥–ª—è –≤–∫–ª–∞–¥–æ–≤ ‚Äî daily savings payment)<br>‚Ä¢ Total debit cards balance widget (–≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞, –ø–æ–¥ Loans/Deposits). | `GET /api/dashboard`<br>–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏: STS, MDP, ADP, Total Balance. | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `sts_today`, `events_next_30d`, `loan_summary` / `savings_summary` (–≤–∫–ª—é—á–∞—è `mdp_today`, `adp_today` –∏–ª–∏ `sdp_today`), `total_debit_cards_balance`, —Ñ–ª–∞–≥–æ–≤ `risk_flags`. |
| 2.2 | Home | –¢–∞–ø–∞–µ—Ç –ø–æ STS-widget |  | `GET /api/analytics/sts-history`<br>(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞ STS. | –ö—ç—à–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω STS (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30 –¥–Ω–µ–π). |
| 2.3 | Home | –¢–∞–ø–∞–µ—Ç –ø–æ Loans total / Deposit total widget (–ø–æ —Å–∞–º–æ–π —Å—É–º–º–µ/–∑–∞–≥–æ–ª–æ–≤–∫—É) | –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞ **Loans Details** (–µ—Å–ª–∏ `mode="debt"`) –∏–ª–∏ **Deposits Details** (–µ—Å–ª–∏ `mode="savings"`). |  | –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—Ä–µ–¥–∏—Ç–æ–≤/–¥–µ–ø–æ–∑–∏—Ç–æ–≤ –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. |
| 2.4 | Home | –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ¬´–û–ø–ª–∞—Ç–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç–µ–∂¬ª (MDP) –∏–ª–∏ ¬´–û–ø–ª–∞—Ç–∏—Ç—å –¥–æ–ø. –ø–ª–∞—Ç–µ–∂¬ª (ADP) –ø—Ä—è–º–æ –≤ Loans widget; –ø—Ä–∏ `mode="savings"` ‚Äî –∫–Ω–æ–ø–∫—É ¬´–ü–æ–ø–æ–ª–Ω–∏—Ç—å –ø–æ –ø–ª–∞–Ω—É¬ª (SDP) –≤–æ –≤–∫–ª–∞–¥–æ—á–Ω–æ–º –≤–∏–¥–∂–µ—Ç–µ | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è **Payment window** –ø–æ–≤–µ—Ä—Ö Home: —Å—É–º–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π MDP/ADP (–¥–ª—è –¥–æ–ª–≥–æ–≤) –∏–ª–∏ SDP (–¥–ª—è –≤–∫–ª–∞–¥–æ–≤), –≤—ã–±–æ—Ä —Å—á—ë—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è | –õ–æ–∫–∞–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏–ª–∏ `GET /api/accounts` –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—á–µ—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è. | –í —Å–æ—Å—Ç–æ—è–Ω–∏–∏ ‚Äî `pending_payment = {type, amount, source_account, target_loan_or_goal, projected_effect}`. |
| 2.5 | Home | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ø–ª–∞—Ç—ë–∂ –∏–∑ Payment window (MDP/ADP/SDP) | –ö–Ω–æ–ø–∫–∞ ¬´–û–ø–ª–∞—Ç–∏—Ç—å¬ª ‚Üí loader, –∑–∞—Ç–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ Loans/Deposits widget –∏ STS widget. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã ¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å¬ª / ¬´–û—Ç–º–µ–Ω–∏—Ç—å¬ª. | `POST /api/payments/plan`<br>–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç "–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π" –ø–ª–∞—Ç–µ–∂, –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç STS/MDP. | –û–±–Ω–æ–≤–ª—è–µ–º `sts_today`, `loan_summary` / `savings_summary` (–æ—Å—Ç–∞—Ç–∫–∏, –Ω–æ–≤—ã–µ `mdp_today`/`adp_today`/`sdp_today`), `payments_history`. –í Home –≤–∏–¥–∂–µ—Ç Loans/Deposits –æ—Ç—Ä–∞–∂–∞–µ—Ç –Ω–æ–≤—ã–µ —Å—É–º–º—ã –∏ —Å—Ç–∞—Ç—É—Å ¬´–ø–ª–∞—Ç—ë–∂ –∑–∞ —Å–µ–≥–æ–¥–Ω—è –≤—ã–ø–æ–ª–Ω–µ–Ω¬ª. |
| 2.6 | Home | –¢–∞–ø–∞–µ—Ç –ø–æ **Total debit cards balance widget** | –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω **Debit Cards Details**: —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–µ–±–µ—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç (–±–∞–Ω–∫, –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–∏—Ñ—Ä—ã, –±–∞–ª–∞–Ω—Å, –≤–∞–ª—é—Ç–∞), —Å—É–º–º–∞—Ä–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫ | `GET /api/accounts?type=debit`<br>–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–µ–±–µ—Ç–æ–≤—ã—Ö —Å—á–µ—Ç–æ–≤. | –û–±–Ω–æ–≤–ª—è–µ–º `debit_cards[]`, `total_debit_cards_balance_details` (—Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –±–∞–Ω–∫–∞–º, –≤–∞–ª—é—Ç–∞–º –∏ —Ç.–ø.) –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏. |
| 2.7 | Bottom nav | –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –≤–∫–ª–∞–¥–∫–∏: Loans|Deposits / Refinance / Profile | –ê–∫—Ç–∏–≤–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è (—Å–∫—Ä–æ–ª–ª, —Ñ–∏–ª—å—Ç—Ä—ã, –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ø–∏—Å–∫–æ–≤). –ù–∞ Home –Ω–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∏–∫–∞–∫ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ–º ‚Äî —Ä–µ—Ñ–∏–Ω–∞–Ω—Å –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–∞—è –≤–∫–ª–∞–¥–∫–∞. |  | –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `active_tab`, –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–∞–∂–¥–æ–π –≤–∫–ª–∞–¥–∫–∏ (—Ñ–∏–ª—å—Ç—Ä—ã, –ø–æ–∑–∏—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∞ –∏ —Ç.–ø.). |

---

### 

---

## 3. Loans total / Deposits total ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∏ —Å–∏–º—É–ª—è—Ç–æ—Ä—ã

### 4.1. Loans Details (—Ä–µ–∂–∏–º ¬´–¥–æ–ª–≥–∏¬ª)

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| 4.1.1 | Loans / Deposits | –ó–∞—Ö–æ–¥–∏—Ç –≤ —Ç–∞–± **Loans** (—Ä–µ–∂–∏–º `user_mode="debt"`) –∏–ª–∏ –≤ —Ç–∞–± **Deposits** (—Ä–µ–∂–∏–º `user_mode="savings"`) ‚Äî –ª–∏–±–æ —á–µ—Ä–µ–∑ Home, –ª–∏–±–æ —á–µ—Ä–µ–∑ –Ω–∏–∂–Ω—é—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é | –í–≤–µ—Ä—Ö—É —ç–∫—Ä–∞–Ω–∞: –≤–∏–¥–∂–µ—Ç **Total balance**.<br>‚Ä¢ –í —Ä–µ–∂–∏–º–µ –¥–æ–ª–≥–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–æ–±—â–∏–π –¥–æ–ª–≥** (—Å—É–º–º–∞ –≤—Å–µ—Ö –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–µ–π) –∏ –¥–≤–µ –ø–æ–¥–ø–ª–∞—à–∫–∏: —Å–ª–µ–≤–∞ ‚Äî `Mandatory daily payment` (MDP), —Å–ø—Ä–∞–≤–∞ ‚Äî `Additional daily payment` (ADP).<br>‚Ä¢ –í —Ä–µ–∂–∏–º–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–æ–±—â–∏–π –æ–±—ä—ë–º –≤–∫–ª–∞–¥–æ–≤/—Å–µ–π–≤–∏–Ω–≥–æ–≤** –∏ –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `Savings daily payment` (SDP).<br>–ù–∏–∂–µ ‚Äî **—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤/–≤–∫–ª–∞–¥–æ–≤** –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –∫—Ä–µ–¥–∏—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç: `bank`, `product_type` (–≤–∏–¥ –∫—Ä–µ–¥–∏—Ç–∞/–≤–∫–ª–∞–¥–∞), `rate`, `balance`, `monthly_payment`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç –∏ –Ω–µ –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–∞ —ç—Ç–æ–º —ç–∫—Ä–∞–Ω–µ. | `GET /api/loans` (–∏–ª–∏ `/api/deposits`)<br>–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º (`loan_ranking_engine`). | –û–±–Ω–æ–≤–ª—è–µ–º: `loan_total_balance` –∏–ª–∏ `savings_total_balance`, `mdp_today`/`adp_today` –∏–ª–∏ `sdp_today`, `loans[]` –∏–ª–∏ `deposits[]`, `loan_risk_flags` (–¥–ª—è –¥–æ–ª–≥–æ–≤). |
| 4.1.2 | Loans / Deposits | –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ¬´–û–ø–ª–∞—Ç–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø–ª–∞—Ç—ë–∂¬ª (MDP) –∏–ª–∏ ¬´–û–ø–ª–∞—Ç–∏—Ç—å –¥–æ–ø. –ø–ª–∞—Ç–µ–∂¬ª (ADP) –≤ –≤–∏–¥–∂–µ—Ç–µ Total balance (–ø—Ä–∏ `mode="debt"`). –í —Ä–µ–∂–∏–º–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π (`mode="savings"`) –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ¬´–ü–æ–ø–æ–ª–Ω–∏—Ç—å –ø–æ –ø–ª–∞–Ω—É¬ª (SDP) | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è **Payment window** –ø–æ–≤–µ—Ä—Ö –≤–∫–ª–∞–¥–∫–∏: —Å—É–º–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = `mdp_today` –∏–ª–∏ `adp_today` (–¥–ª—è –¥–æ–ª–≥–æ–≤) –ª–∏–±–æ `sdp_today` (–¥–ª—è –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–π), –≤—ã–±–æ—Ä —Å—á—ë—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è (–æ–¥–Ω–∞ –∏–∑ –¥–µ–±–µ—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç/—Å—á–µ—Ç–æ–≤) | –õ–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ `GET /api/accounts`. | –í —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ–∑–¥–∞—ë–º `pending_payment = {type, amount, source_account, target_loans_or_goal, projected_effect}`. |
| 4.1.3 | Loans / Deposits | –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–µ–Ω—è–µ—Ç —Å—É–º–º—É –ø–ª–∞—Ç–µ–∂–∞ –≤ Payment window –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É |  –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ¬´–û–ø–ª–∞—Ç–∏—Ç—å¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ–º loader, –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–∂–µ—Ç–µ Total balance –∏ –≤ —Å–ø–∏—Å–∫–µ –∫—Ä–µ–¥–∏—Ç–æ–≤/–≤–∫–ª–∞–¥–æ–≤. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã ¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å¬ª / ¬´–û—Ç–º–µ–Ω–∏—Ç—å¬ª. | `POST /api/payments/plan`<br>–§–∏–∫—Å–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞. | –û–±–Ω–æ–≤–ª—è–µ–º: `loans[]` –∏–ª–∏ `deposits[]` (–æ—Å—Ç–∞—Ç–∫–∏), `loan_total_balance` –∏–ª–∏ `savings_total_balance`, `mdp_today`/`adp_today` –∏–ª–∏ `sdp_today` (—Å —É—á—ë—Ç–æ–º —É–∂–µ –æ–ø–ª–∞—á–µ–Ω–Ω–æ–≥–æ –¥–Ω—è), `sts_today`, `payments_history`. –í–∏–¥–∂–µ—Ç Total balance –æ—Ç—Ä–∞–∂–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç—É—Å ¬´–ø–ª–∞—Ç—ë–∂ –∑–∞ —Å–µ–≥–æ–¥–Ω—è –≤—ã–ø–æ–ª–Ω–µ–Ω¬ª. |
| 4.1.4 | Loans / Deposits | –°–∫—Ä–æ–ª–ª–∏—Ç —Å–ø–∏—Å–æ–∫ –∫—Ä–µ–¥–∏—Ç–æ–≤/–≤–∫–ª–∞–¥–æ–≤ –∏–ª–∏ —Ç–∞–ø–∞–µ—Ç –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫—Ä–µ–¥–∏—Ç—É/–≤–∫–ª–∞–¥—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π | –°–ø–∏—Å–æ–∫ –∫—Ä–µ–¥–∏—Ç–æ–≤/–≤–∫–ª–∞–¥–æ–≤ –≤–∏–¥–µ–Ω –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.   | `GET /api/loans/{id}`<br>(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. | `current_loan` –∏–ª–∏ `current_deposit` –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –Ω–∞ —ç—Ç–æ—Ç —ç–∫—Ä–∞–Ω –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å–≤–µ–∂–∏–µ. |

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| 4.2.1 | Deposits (—Ä–µ–∂–∏–º `user_mode="savings"`) | –ó–∞—Ö–æ–¥–∏—Ç –≤ —Ç–∞–± **Deposits** ‚Äî –ª–∏–±–æ —á–µ—Ä–µ–∑ Home –ø–æ Deposit total widget, –ª–∏–±–æ —á–µ—Ä–µ–∑ –Ω–∏–∂–Ω—é—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é | –í–≤–µ—Ä—Ö—É —ç–∫—Ä–∞–Ω–∞: –≤–∏–¥–∂–µ—Ç **Total savings balance** ‚Äî –æ–±—â–∏–π –æ–±—ä—ë–º –≤–∫–ª–∞–¥–æ–≤/—Å–µ–π–≤–∏–Ω–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä **Savings daily payment (SDP)** –Ω–∞ —Å–µ–≥–æ–¥–Ω—è. –ù–∏–∂–µ ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–µ–ø–æ–∑–∏—Ç–æ–≤/–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—á–µ—Ç–æ–≤ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–µ–ø–æ–∑–∏—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç: `bank`, `product_type` (–≤–∏–¥ –≤–∫–ª–∞–¥–∞/—Å–µ–π–≤–∏–Ω–≥–∞), `rate`, `balance` | `GET /api/deposits`<br>–°–ø–∏—Å–æ–∫ –≤–∫–ª–∞–¥–æ–≤. | –û–±–Ω–æ–≤–ª—è–µ–º: `savings_total_balance`, `sdp_today`, `deposits[]`, `savings_goal_amount`, `savings_goal_date`, `savings_goal_progress`, `savings_projection`, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî `savings_risk_flags` (–µ—Å–ª–∏ —Ü–µ–ª—å –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–∞ –ø—Ä–∏ —Ç–µ–∫—É—â–µ–º —Ç–µ–º–ø–µ). |
| 4.2.2 | Deposits (—Ä–µ–∂–∏–º `user_mode="savings"`) | –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É ¬´–ü–æ–ø–æ–ª–Ω–∏—Ç—å –ø–æ –ø–ª–∞–Ω—É¬ª (SDP) –≤ –≤–∏–¥–∂–µ—Ç–µ Total savings balance | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è **Payment window** –ø–æ–≤–µ—Ä—Ö –≤–∫–ª–∞–¥–∫–∏ Deposits: —Å—É–º–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = `sdp_today`, –≤—ã–±–æ—Ä —Å—á—ë—Ç–∞ —Å–ø–∏—Å–∞–Ω–∏—è (–æ–¥–Ω–∞ –∏–∑ –¥–µ–±–µ—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç/—Å—á–µ—Ç–æ–≤) | –õ–æ–∫–∞–ª—å–Ω–æ –∏–ª–∏ `GET /api/accounts`. | –í —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å–æ–∑–¥–∞—ë–º `pending_payment = {type: "SDP", amount: sdp_today, source_account, savings_goal_id, projected_goal_date, projected_effect}`. |
| 4.2.3 | Deposits (—Ä–µ–∂–∏–º `user_mode="savings"`) | –ú–µ–Ω—è–µ—Ç —Å—É–º–º—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ Payment window –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É | –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ¬´–û–ø–ª–∞—Ç–∏—Ç—å¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ–º loader, –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–∂–µ—Ç–µ Total savings balance –∏ –≤ —Å–ø–∏—Å–∫–µ –¥–µ–ø–æ–∑–∏—Ç–æ–≤. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ ‚Äî —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã ¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å¬ª / ¬´–û—Ç–º–µ–Ω–∏—Ç—å¬ª. | `POST /api/payments/plan`<br>–§–∏–∫—Å–∞—Ü–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è. | –û–±–Ω–æ–≤–ª—è–µ–º: `deposits[]` (–±–∞–ª–∞–Ω—Å—ã), `savings_total_balance`, `sdp_today` (—Å —É—á—ë—Ç–æ–º —É–∂–µ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–≥–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞ –¥–µ–Ω—å), `savings_goal_progress`, `savings_projection`, `sts_today`, `payments_history`. –í–∏–¥–∂–µ—Ç Total savings balance –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –±–∞–ª–∞–Ω—Å—ã –∏ —Å—Ç–∞—Ç—É—Å ¬´–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞ —Å–µ–≥–æ–¥–Ω—è –≤—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª. |
| 4.2.4 | Deposits (—Ä–µ–∂–∏–º `user_mode="savings"`) | –°–∫—Ä–æ–ª–ª–∏—Ç —Å–ø–∏—Å–æ–∫ –≤–∫–ª–∞–¥–æ–≤/—Å–µ–π–≤–∏–Ω–≥–æ–≤  | –°–ø–∏—Å–æ–∫ –¥–µ–ø–æ–∑–∏—Ç–æ–≤/—Å–µ–π–≤–∏–Ω–≥–æ–≤ –≤–∏–¥–µ–Ω —Å—Ä–∞–∑—É. (—Å—Ç–∞–≤–∫–∞, —Å—Ä–æ–∫, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫, –∫–∞–ø–∏—Ç–∞–ª–∏–∑–∞—Ü–∏—è) | `GET /api/deposits/{id}`<br>(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ). | –í —Å–æ—Å—Ç–æ—è–Ω–∏–∏: `current_deposit` (–¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö), –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ Refinance ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ–º `current_refi_context = {type: "deposit", current_deposit, offers[]}` –ø–æ—Å–ª–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ `/refi/deposit-offers`. |

### 4.2. Deposits Details (—Ä–µ–∂–∏–º ¬´–Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ¬ª)

---

## 5. Refinancing ‚Äî –∫—Ä–µ–¥–∏—Ç—ã –∏ –¥–µ–ø–æ–∑–∏—Ç—ã

### 5.1. Refinance —Ç–∞–± ‚Äî –∫—Ä–µ–¥–∏—Ç—ã

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| 5.1.1 | Refinance | –ó–∞—Ö–æ–¥–∏—Ç –≤ —Ç–∞–± | –°–ø–∏—Å–æ–∫ –∫—Ä–µ–¥–∏—Ç–æ–≤ + –∫–Ω–æ–ø–∫–∞ ¬´–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–µ–¥–∏—Ç—ã¬ª | `GET /api/refinance/offers`<br>–ó–∞–ø—É—Å–∫–∞–µ—Ç `best_financing_offer_selector`. | refi_loans[], total_debt |
| 5.1.2 | Refinance Optimization | –ñ–º—ë—Ç ¬´–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–µ–¥–∏—Ç—ã¬ª | –ü–µ—Ä–µ—Ö–æ–¥ —Å—Ä–∞–∑—É –Ω–∞ —ç–∫—Ä–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | `POST /api/refinance/optimize`<br>(–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Å—á–µ—Ç). | refi_strategy, refi_offer |
| 5.1.3 | Refinance Offer | –ñ–º—ë—Ç ¬´–í—ã–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç¬ª | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ (–æ–¥–Ω–æ –ø–æ–ª–µ) | –õ–æ–∫–∞–ª—å–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ. | pending_refi_offer |
| 5.1.4 | Refinance Application | –ñ–º—ë—Ç ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å¬ª | Loader 0.5s ‚Üí —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ | `POST /api/refinance/apply`<br>–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –≤ –±–∞–Ω–∫. | application_status |
| 5.1.5 | Refinance Result | –ß–∏—Ç–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –û—Å—Ç–∞—ë—Ç—Å—è –≤ —ç—Ç–æ–º –∂–µ –æ–∫–Ω–µ | - | loans[], sts_today |

### 5.2. Refinance —Ç–∞–± ‚Äî –¥–µ–ø–æ–∑–∏—Ç—ã / –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| 5.2.1 | Refinance (savings) | –ó–∞—Ö–æ–¥–∏—Ç –≤ —Ç–∞–± **Refinance** –ø—Ä–∏ `user_mode="savings"` | –≠–∫—Ä–∞–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: —Å–≤–µ—Ä—Ö—É –∫–Ω–æ–ø–∫—É **¬´–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è¬ª**, –Ω–∏–∂–µ ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–≤/–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—á–µ—Ç–æ–≤ (–±–∞–Ω–∫, –ø—Ä–æ–¥—É–∫—Ç, —Å—Ç–∞–≤–∫–∞, –±–∞–ª–∞–Ω—Å, —Å—Ä–æ–∫). | `GET /api/refinance/deposits`<br>–ü–æ–∏—Å–∫ –ª—É—á—à–∏—Ö –≤–∫–ª–∞–¥–æ–≤. | `refi_deposits[]`, `total_savings`, `savings_goal` (–µ—Å–ª–∏ –∑–∞–¥–∞–Ω–∞). |
| 5.2.2 | Refinance (savings) | –ù–∞–∂–∏–º–∞–µ—Ç ¬´–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è¬ª | –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —ç–∫—Ä–∞–Ω —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚Äî –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏, —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥–æ–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç. | `POST /api/refinance/optimize`<br>(–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –ø–µ—Ä–µ—Å—á–µ—Ç). | `best_deposit_offer` (—Å—Ç–∞–≤–∫–∞, —Ç–∏–ø, –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, –≤–ª–∏—è–Ω–∏–µ –Ω–∞ —Ü–µ–ª—å). |
| 5.2.3 | Refinance ‚Äî Best offer | –í–∏–¥–∏—Ç –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç | –ù–∞ —ç–∫—Ä–∞–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ä–∞—Ç–∫–æ:<br>‚Ä¢ —Ç–µ–∫—É—â–∏–µ —É—Å–ª–æ–≤–∏—è (—Å—Ç–∞–≤–∫–∞, –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, —Å—Ä–æ–∫, –ø—Ä–æ–≥–Ω–æ–∑ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏)<br>‚Ä¢ –Ω–æ–≤—ã–µ —É—Å–ª–æ–≤–∏—è (—Å—Ç–∞–≤–∫–∞, –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–π –¥–æ—Ö–æ–¥, –Ω–æ–≤–∞—è –¥–∞—Ç–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏)<br>–ö–Ω–æ–ø–∫–∞: **¬´–í—ã–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç¬ª**. | - | `selected_deposit_offer = best_deposit_offer`. |
| 5.2.4 | Refinance ‚Äî Application | –ù–∞–∂–∏–º–∞–µ—Ç ¬´–í—ã–±—Ä–∞—Ç—å —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç¬ª | –ù–∞ —ç—Ç–æ–º –∂–µ —Å—Ç–µ–∫–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è —Ñ–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏: –æ–¥–Ω–æ –ø–æ–ª–µ ¬´–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏ –±–∞–Ω–∫–∞¬ª –∏ –∫–Ω–æ–ø–∫–∞ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª. | - | `pending_deposit_offer = selected_deposit_offer`. |
| 5.2.5 | Refinance ‚Äî Application | –ó–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –∂–º—ë—Ç ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É¬ª | –ü–æ—è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä–æ—Ç–∫–∏–π loader, –∑–∞—Ç–µ–º –ø—Ä—è–º–æ –≤ —ç—Ç–æ–º –∂–µ –æ–∫–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç. | `POST /api/refinance/apply`<br>–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏. | `deposit_application_status`. |
| 5.2.6 | Refinance ‚Äî Result | –°–º–æ—Ç—Ä–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –ï—Å–ª–∏ **approved**: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç ¬´–ë–∞–Ω–∫ –æ–¥–æ–±—Ä–∏–ª. –ú—ã –ø–µ—Ä–µ–≤–µ–ª–∏ –≤–∞—à–∏ —Å–±–µ—Ä–µ–∂–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç.¬ª –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –≤–∫–ª–∞–¥–∞–º/—Å–µ–π–≤–∏–Ω–≥–∞–º. –ï—Å–ª–∏ **declined**: —Ç–µ–∫—Å—Ç ¬´–ë–∞–Ω–∫ –Ω–µ –æ–¥–æ–±—Ä–∏–ª –∑–∞—è–≤–∫—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.¬ª ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ —ç—Ç–æ–º –∂–µ —ç–∫—Ä–∞–Ω–µ, –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥. | - |  |

---

## 6. –ü—Ä–æ—Ñ–∏–ª—å

| Step ID | Screen / Tab | User action | Frontend behavior | Backend / Analytics | State update |
| --- | --- | --- | --- | --- | --- |
| 6.1 | Profile | –ó–∞—Ö–æ–¥–∏—Ç –≤ —Ç–∞–± **Profile** | –ü–æ–∫–∞–∑—ã–≤–∞–µ–º: <br>‚Ä¢ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br>‚Ä¢ —Ç–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ: Free / Premium <br>‚Ä¢ –±–ª–æ–∫ ¬´–ü–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –±–∞–Ω–∫–∏¬ª (–ª–æ–≥–æ—Ç–∏–ø + –Ω–∞–∑–≤–∞–Ω–∏–µ + —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è) <br>‚Ä¢ –±–ª–æ–∫ ¬´–ü–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã¬ª (–∫–æ–ª-–≤–æ –∫—Ä–µ–¥–∏—Ç–æ–≤, –≤–∫–ª–∞–¥–æ–≤, –∫–∞—Ä—Ç –ø–æ –≤—Å–µ–º –±–∞–Ω–∫–∞–º —Å—É–º–º–∞—Ä–Ω–æ) <br>‚Ä¢ –∫–Ω–æ–ø–∫—É **¬´–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–ª–∞—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é¬ª**, –µ—Å–ª–∏ —Ç–∞—Ä–∏—Ñ = Free | `GET /api/profile`<br>–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –∏ —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏. | –û–±–Ω–æ–≤–ª—è–µ–º `user_profile`, `subscription_plan`, `connected_banks[]`, `products_overview`. |
| 6.2 | Profile | –°–∫—Ä–æ–ª–ª–∏—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã—Ö –±–∞–Ω–∫–æ–≤ –∏ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ | –ü—Ä–æ—Å—Ç–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: –ø–æ –∫–∞–∂–¥–æ–º—É –±–∞–Ω–∫—É ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ/–ª–æ–≥–æ—Ç–∏–ø –∏ –∫—Ä–∞—Ç–∫–∏–π —Å—Ç–∞—Ç—É—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è¬ª / ¬´–ø–æ–¥–∫–ª—é—á–µ–Ω¬ª), –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º ‚Äî ¬´–ö—Ä–µ–¥–∏—Ç—ã: X, –í–∫–ª–∞–¥—ã: Y, –ö–∞—Ä—Ç—ã: Z¬ª. | - | –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É–µ–º `connected_banks[]`, `products_overview`. |
| 6.3 | Profile | –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É **¬´–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–ª–∞—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é¬ª** (–ø—Ä–∏ —Ç–∞—Ä–∏—Ñ–µ Free) | –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —ç–∫—Ä–∞–Ω/–¥–∏–∞–ª–æ–≥ ¬´–ü–æ–¥–ø–∏—Å–∫–∞¬ª: –∫—Ä–∞—Ç–∫–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Premium (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, —Ä–∞–Ω–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è). –ö–Ω–æ–ø–∫–∞ **¬´–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É¬ª**. | `GET /api/profile/plans`<br>–°–ø–∏—Å–æ–∫ —Ç–∞—Ä–∏—Ñ–æ–≤. | –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ `available_plans`, `selected_plan = "Premium"` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. |
| 6.4 | Profile | –ù–∞–∂–∏–º–∞–µ—Ç ¬´–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É¬ª | –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º (–∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –≤—ã–±–æ—Ä–æ–º —Å–ø–æ—Å–æ–±–∞ –æ–ø–ª–∞—Ç—ã ‚Äî –¥–µ–º–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≥–ª—É—à–∫–æ–π ¬´–û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –±–∞–Ω–∫ X¬ª). –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Äî —Å—Ç–∞—Ç—É—Å ¬´–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞¬ª. | `POST /api/profile/subscription`<br>–ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏. | –û–±–Ω–æ–≤–ª—è–µ–º `subscription_plan = "Premium"`, –≤–∫–ª—é—á–∞–µ–º –≤ UI Premium-–ª–µ–π–±–ª, —Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É ¬´–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–ª–∞—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é¬ª. |
| 6.5 | Profile | –ó–∞—Ö–æ–¥–∏—Ç –≤ —Ç–∞–± Profile –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–æ—Å–ª–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ | –í–∏–¥–∏—Ç: <br>‚Ä¢ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è <br>‚Ä¢ —Å—Ç–∞—Ç—É—Å: **Premium** <br>‚Ä¢ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –±–∞–Ω–∫–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç—ã (–∫–∞–∫ –≤ 6.1) <br>‚Ä¢ –≤–º–µ—Å—Ç–æ –∫–Ω–æ–ø–∫–∏ ¬´–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–ª–∞—Ç–Ω—É—é –≤–µ—Ä—Å–∏—é¬ª ‚Äî –º–µ—Ç–∫–∞ ¬´–ü–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞¬ª –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è. | `GET /api/profile`<br>–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å. | –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É–µ–º `subscription_plan`, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º Premium-—Å—Ç–∞—Ç—É—Å –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –±–∞–Ω–∫–∞–º/–ø—Ä–æ–¥—É–∫—Ç–∞–º. |

---

---

---

---

# –¢–∞–±–ª–∏—Ü–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤

| –ê–ª–≥–æ—Ä–∏—Ç–º | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ (—Ñ—É–Ω–∫—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞) | –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ | –ü—Ä–∞–≤–∏–ª–∞ / –§–æ—Ä–º—É–ª—ã |
| --- | --- | --- | --- | --- |
| transactions_categorization_salary_and_loans | –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –≤—ã–¥–µ–ª—è–µ—Ç –¥–≤–µ –∫–ª—é—á–µ–≤—ã–µ –≤–µ—â–∏: 1) –∫–æ–≥–¥–∞ –∏ —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∑–∞—Ä–ø–ª–∞—Ç–∞, 2) –∫–æ–≥–¥–∞ –∏ —Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–ª–∞—Ç–∏—Ç –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º. | **1. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∏—Å—Ç–æ—Ä–∏—è):**<br>‚Ä¢¬†bookingDateTime¬†(UTC)<br>‚Ä¢¬†amount,¬†currency<br>‚Ä¢¬†creditDebitIndicator<br>‚Ä¢¬†transactionInformation<br>‚Ä¢¬†bankTransactionCode<br><br>**2. –ö—Ä–µ–¥–∏—Ç–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã (Agreements):**<br>‚Ä¢¬†agreement_id<br>‚Ä¢¬†account_number¬†(—Å—á–µ—Ç –ø–æ–≥–∞—à–µ–Ω–∏—è)<br>‚Ä¢¬†product_type¬†(loan, mortgage)<br>‚Ä¢¬†payment_schedule¬†(—Å—É–º–º–∞ –∏ –¥–∞—Ç–∞ –ø–ª–∞–Ω–æ–≤–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞) ‚Äî¬†*–µ—Å–ª–∏ API –Ω–µ –æ—Ç–¥–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫, –±–µ—Ä–µ–º min_payment –∏–ª–∏ annuity calculation*.<br><br>**3. –ö–æ–Ω—Ç–µ–∫—Å—Ç:**<br>‚Ä¢¬†user_timezone¬†(–ø–æ –¥–µ—Ñ–æ–ª—Ç—É 'Europe/Moscow', –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω)<br>‚Ä¢¬†salary_keywords:¬†["–∑–∞—Ä–ø–ª–∞—Ç–∞", "salary", "payroll", "–∞–≤–∞–Ω—Å", "–ø—Ä–µ–º–∏—è", "–¥–æ—Ö–æ–¥"] | estimated_monthly_income¬†(—á–∏—Å—Ç—ã–π —Å—Ä–µ–¥–Ω–µ–º–µ—Å—è—á–Ω—ã–π –¥–æ—Ö–æ–¥)<br>‚Ä¢¬†income_frequency_type¬†("regular_monthly",¬†"regular_biweekly",¬†"irregular"/—Ö–∞–æ—Ç–∏—á–Ω—ã–π)<br>‚Ä¢¬†next_income_window¬†(–¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç:¬†{start, end})<br>‚Ä¢¬†debt_obligations_status[]: –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤¬†{agreement_id, planned_amount, paid_in_current_period (bool), last_payment_date, source} | **–≠–¢–ê–ü 1: –†–∞—Å—á–µ—Ç –î–æ—Ö–æ–¥–∞ (Income)**<br><br>**1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**<br>–ö–∞–∂–¥—É—é –¥–∞—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º –∏–∑ UTC –≤¬†user_timezone.<br>–û—Ç–±–∏—Ä–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≥–¥–µ¬†Indicator='Credit'¬†–ò (Code='02'¬†–ò–õ–ò¬†Info¬†—Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–∞ –∏–∑¬†salary_keywords¬†(lower case)).<br><br>**2. –ú–µ—Å—è—á–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è (Monthly Aggregation):**<br>–ì—Ä—É–ø–ø–∏—Ä—É–µ–º –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –∫–ª—é—á—É¬†YYYY-MM.<br>¬†Sums[]¬†= —Å–ø–∏—Å–æ–∫ —Å—É–º–º –∑–∞ –∫–∞–∂–¥—ã–π –ø–æ–ª–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–π –º–µ—Å—è—Ü.<br>¬†–ò—Å–∫–ª—é—á–∞–µ–º —Ç–µ–∫—É—â–∏–π (–Ω–µ–ø–æ–ª–Ω—ã–π) –º–µ—Å—è—Ü –∏–∑ —Ä–∞—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ, –µ—Å–ª–∏ –≤ –Ω–µ–º —Å—É–º–º–∞ –ø–æ–∫–∞ –º–µ–Ω—å—à–µ 50% –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ.<br><br>**3. –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–æ—Ö–æ–¥–∞:**<br>–ï—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è < 1 –º–µ—Å—è—Ü–∞ –∏–ª–∏¬†Sums¬†–ø—É—Å—Ç:¬†estimated_monthly_income = 0¬†(—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–π –≤–≤–æ–¥).<br>–ò–Ω–∞—á–µ:¬†estimated_monthly_income¬†=¬†**Median(Sums)**.¬†–≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤ –≤ "–ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ" –º–µ—Å—è—Ü—ã, –Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç –¥—Ä–æ–±–ª–µ–Ω–∏–µ –ó–ü.<br><br>**4. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç–∏ (Frequency):**<br>–°—á–∏—Ç–∞–µ–º –¥–Ω–∏ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∑–∞—Ä–ø–ª–∞—Ç–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ (gaps).<br>–ï—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (std_dev)¬†gaps¬†> 5 –¥–Ω–µ–π ‚Üí¬†type = "irregular". –ü—Ä–æ–≥–Ω–æ–∑ –¥–∞—Ç—ã: 1-–µ —á–∏—Å–ª–æ —Å–ª–µ–¥. –º–µ—Å—è—Ü–∞.<br>–ò–Ω–∞—á–µ ‚Üí –±–µ—Ä–µ–º –º–µ–¥–∏–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª. –ü—Ä–æ–≥–Ω–æ–∑:¬†last_date + median_interval.<br><br>--<br><br>**–≠–¢–ê–ü 2: –û–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –ø–æ –¥–æ–ª–≥–∞–º (Debt Obligations)**<br><br>**1. –°–±–æ—Ä "–ò—Å—Ç–∏–Ω—ã" (Contracts First):**<br>–°–æ–∑–¥–∞–µ–º —Å–ø–∏—Å–æ–∫¬†obligations¬†–Ω–∞ –æ—Å–Ω–æ–≤–µ¬†**–∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–≥–æ–≤–æ—Ä–æ–≤**¬†(status='active').<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞ –±–µ—Ä–µ–º¬†planned_amount¬†–∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π (–µ—Å–ª–∏ –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–µ—Ç ‚Äî —Å—Ç–∞–≤–∏–º —Ñ–ª–∞–≥¬†need_schedule_update).<br><br>**2. –ú–∞—Ç—á–∏–Ω–≥ —Ñ–∞–∫—Ç–∞ –æ–ø–ª–∞—Ç—ã (Transactions Check):**<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ¬†obligation: –∏—â–µ–º –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ (Indicator='Debit') –∑–∞–ø–∏—Å–∏, –≥–¥–µ:<br>¬†–∞)¬†Info¬†—Å–æ–¥–µ—Ä–∂–∏—Ç¬†agreement_id<br>¬†–±) –ò–õ–ò –ø–æ–ª—É—á–∞—Ç–µ–ª—å –ø–µ—Ä–µ–≤–æ–¥–∞ =¬†account_number¬†–∫—Ä–µ–¥–∏—Ç–∞.<br>–ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –∏ —Å—É–º–º–∞ ‚â•¬†planned_amount¬†0.9 ‚Üí —Å—Ç–∞–≤–∏–º¬†paid_in_current_period = True.<br><br>**3. –û–±—Ä–∞–±–æ—Ç–∫–∞ "–ü—É—Å—Ç—ã—Ö" (Edge Case):**<br>–ï—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–µ—Ç (–ø—Ä–æ—Ñ–∏–ª—å –°–∏–¥–æ—Ä–æ–≤–∞), –∞–ª–≥–æ—Ä–∏—Ç–º –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤ –∏–∑ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º¬†paid = False. STS-–¥–≤–∏–∂–æ–∫ —É–≤–∏–¥–∏—Ç —ç—Ç–æ –∏ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –¥–µ–Ω—å–≥–∏. |
| total_debit_balance_calculation | –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –≤—Å–µ–º –¥–µ–±–µ—Ç–æ–≤—ã–º –∫–∞—Ä—Ç–∞–º –∏ –ª–∏–∫–≤–∏–¥–Ω—ã–º —Å—á–µ—Ç–∞–º. | **1. –°–ø–∏—Å–æ–∫ —Å—á–µ—Ç–æ–≤ (/accounts):**<br>‚Ä¢ accountId<br>‚Ä¢ accountSubType (Checking, Current, Savings)<br>‚Ä¢ status<br>‚Ä¢ currency<br><br>**2. –ë–∞–ª–∞–Ω—Å—ã (/balances):**<br>‚Ä¢ type (–∏—â–µ–º —Ç–æ–ª—å–∫–æ InterimAvailable)<br>‚Ä¢ amount<br>‚Ä¢ creditDebitIndicator (Credit / Debit)<br><br>**3. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫:**<br>‚Ä¢ fx_rates (–∫—É—Ä—Å—ã –≤–∞–ª—é—Ç –∫ RUB, –µ—Å–ª–∏ –≤–∞–ª—é—Ç–∞ —Å—á–µ—Ç–∞ != RUB). | total_debit_balance_base ‚Äî –∏—Ç–æ–≥–æ–≤–∞—è —Å—É–º–º–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ (RUB). | **1. Whitelist-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—á–µ—Ç–æ–≤:**<br>–£—á–∏—Ç—ã–≤–∞–µ–º —Å—á–µ—Ç, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:<br>status == "Enabled" (–∏–ª–∏ "Active")<br>–ò accountSubType –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫ –¥–µ–±–µ—Ç–æ–≤—ã—Ö: ["Checking", "CurrentAccount", "Savings", "Personal"].<br>(–ò—Å–∫–ª—é—á–∞–µ–º "CreditCard", "Loan", "Mortgage", —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –¥–æ–ª–≥–∏, –∞ –Ω–µ –∞–∫—Ç–∏–≤—ã).<br><br>**2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ –æ—Å—Ç–∞—Ç–∫–∞ (Raw Balance):**<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä —Å—á–µ—Ç–∞ –±–µ—Ä–µ–º –∑–∞–ø–∏—Å—å –∏–∑ /balances, –≥–¥–µ type == "InterimAvailable":<br>–ï—Å–ª–∏ creditDebitIndicator == "Credit" ‚Üí raw = amount.<br>–ï—Å–ª–∏ creditDebitIndicator == "Debit" ‚Üí raw = -amount.<br><br>**3. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è STS:**<br>–¢–∞–∫ –∫–∞–∫ –º—ã —Å—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è —Ç—Ä–∞—Ç:<br>safe_balance = max(0, raw).<br>(–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –¥–µ–±–µ—Ç–æ–≤–æ–π –∫–∞—Ä—Ç—ã ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ–≤–µ—Ä–¥—Ä–∞—Ñ—Ç, —Ç—Ä–∞—Ç–∏—Ç—å –µ–≥–æ –Ω–µ–ª—å–∑—è, –ø–æ—ç—Ç–æ–º—É —Å—á–∏—Ç–∞–µ–º –∑–∞ 0).<br><br>**4. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏ –°—É–º–º–∞:**<br>–ï—Å–ª–∏ currency != "RUB" ‚Üí base_balance = safe_balance * fx_rate.<br>–ò–Ω–∞—á–µ base_balance = safe_balance.<br><br>**5. –ò—Ç–æ–≥:**<br>total_debit_balance_base = SUM(base_balance) –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º. |
| total_debt_calculation | –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±—â—É—é –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–∞: –∫—Ä–µ–¥–∏—Ç—ã + –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã. | **1. –°–ø–∏—Å–æ–∫ –¥–æ–≥–æ–≤–æ—Ä–æ–≤ (/product-agreements):**<br>‚Ä¢ agreement_id<br>‚Ä¢ product_type (–æ–∂–∏–¥–∞–µ–º "loan" –∏–ª–∏ "credit_card")<br>‚Ä¢ status<br>‚Ä¢ amount (–≤ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö —ç—Ç–æ –æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞)<br>‚Ä¢ currency<br>‚Ä¢ overdue_amount (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å)<br><br>**2. –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫:**<br>‚Ä¢ fx_rates (–∫—É—Ä—Å—ã –≤–∞–ª—é—Ç). | total_debt_base (–û–±—â–∏–π –¥–æ–ª–≥ –≤ RUB)<br>‚Ä¢ total_loans_debt_base (–¢–æ–ª—å–∫–æ –∫—Ä–µ–¥–∏—Ç—ã/–∏–ø–æ—Ç–µ–∫–∞)<br>‚Ä¢ total_cards_debt_base (–¢–æ–ª—å–∫–æ –∫—Ä–µ–¥–∏—Ç–∫–∏)<br>‚Ä¢ active_loans[] (–°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–ª–≥–æ–≤ –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏) | **1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–ª–≥–æ–≤:**<br>–ë–µ—Ä–µ–º –¥–æ–≥–æ–≤–æ—Ä, –ï–°–õ–ò:<br>status == "active" (–∏–ª–∏ "in_arrears", –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è —Ç–∞–∫–æ–π —Å—Ç–∞—Ç—É—Å).<br>–ò product_type –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫: ["loan", "credit_card", "overdraft"].<br>(–í–Ω–∏–º–∞–Ω–∏–µ: –≤ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–ø–æ—Ç–µ–∫–∞ –∏ –ø–æ—Ç—Ä–µ–±. –∫—Ä–µ–¥–∏—Ç—ã –∏–º–µ—é—Ç —Ç–∏–ø "loan").<br><br>**2. –†–∞—Å—á–µ—Ç –¥–æ–ª–≥–∞ –ø–æ –ö—Ä–µ–¥–∏—Ç–∞–º (type="loan"):**<br>–¢–∞–∫ –∫–∞–∫ –≤ JSON –ø–æ–ª–µ principal_outstanding –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–µ amount:<br>loan_debt = agreement.amount<br>overdue = agreement.get("overdue_amount", 0.0)<br>total_loan_item = loan_debt + overdue<br><br>**3. –†–∞—Å—á–µ—Ç –¥–æ–ª–≥–∞ –ø–æ –ö–∞—Ä—Ç–∞–º (type="credit_card"):**<br>–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å–∫–∞–¥–Ω—É—é –ª–æ–≥–∏–∫—É (Waterfall), —Ç–∞–∫ –∫–∞–∫ —Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è:<br>–ï—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª–µ outstanding_balance ‚Üí –±–µ—Ä–µ–º –µ–≥–æ.<br>–ò–Ω–∞—á–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª–µ used_amount ‚Üí –±–µ—Ä–µ–º –µ–≥–æ.<br>–ò–Ω–∞—á–µ –±–µ—Ä–µ–º –ø–æ–ª–µ amount (–∫–∞–∫ fallback).<br>–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç ‚Üí 0.0 (–∏ –ø–∏—à–µ–º Warning –≤ –ª–æ–≥).<br><br>**4. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏ –ê–≥—Ä–µ–≥–∞—Ü–∏—è:**<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –¥–æ–ª–≥–∞:<br>–ï—Å–ª–∏ currency != "RUB", —É–º–Ω–æ–∂–∞–µ–º –Ω–∞ fx_rate.<br>–°—É–º–º–∏—Ä—É–µ–º:<br> total_loans_debt_base = —Å—É–º–º–∞ –ø–æ "loan"<br> total_cards_debt_base = —Å—É–º–º–∞ –ø–æ "credit_card"<br> total_debt_base = —Å—É–º–º–∞ –≤—Å–µ—Ö. |
| mdp_calculation | –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç Mandatory Daily Payments ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏. | **1. –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ–ª–≥–æ–≤ (–∏–∑ Alg: total_debt):**<br>‚Ä¢¬†agreement_id<br>‚Ä¢¬†amount¬†(—Ç–µ–∫—É—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞)<br>‚Ä¢¬†interest_rate¬†(–≥–æ–¥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞, %)<br>‚Ä¢¬†start_date¬†(–¥–∞—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è)<br>‚Ä¢¬†product_type<br><br>**2. –°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã (–∏–∑ Alg: categorization):**<br>‚Ä¢¬†debt_obligations_status[]¬†(—Å–æ–¥–µ—Ä–∂–∏—Ç¬†planned_amount,¬†paid_in_current_period,¬†next_payment_date¬†‚Äî –µ—Å–ª–∏ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏).<br><br>**3. –ö–æ–Ω—Ç–µ–∫—Å—Ç:**<br>‚Ä¢¬†today¬†(—Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞, Timezone-aware). | mdp_today_base¬†(–°—É–º–º–∞ –∫ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—é —Å–µ–≥–æ–¥–Ω—è, RUB).<br>‚Ä¢¬†per_loan_mdp[]¬†(–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –∫—Ä–µ–¥–∏—Ç–∞–º). | **–≠–¢–ê–ü 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ü–ª–∞–Ω–æ–≤–æ–≥–æ –ü–ª–∞—Ç–µ–∂–∞ (Monthly_Payment)**<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞:<br>1.¬†**–ü–æ–∏—Å–∫ —Ñ–∞–∫—Ç–∞:**¬†–ï—Å–ª–∏ –≤¬†debt_obligations_status¬†–µ—Å—Ç—å¬†planned_amount¬†> 0 ‚Üí –±–µ—Ä–µ–º –µ–≥–æ.<br>2.¬†**Fallback (–≠–≤—Ä–∏—Å—Ç–∏–∫–∞):**¬†–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –æ—Ü–µ–Ω–∏–≤–∞–µ–º –∞–Ω–Ω—É–∏—Ç–µ—Ç + –ø–æ–≥–∞—à–µ–Ω–∏–µ —Ç–µ–ª–∞:<br>¬†interest_part = amount * (interest_rate / 100 / 12)<br>¬†principal_part = amount * 0.01¬†(–º–∏–Ω. –≥–∞—à–µ–Ω–∏–µ —Ç–µ–ª–∞ 1%)<br>¬†Monthly_Payment = interest_part + principal_part<br><br>**–≠–¢–ê–ü 2: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –î–∞—Ç—ã –ü–ª–∞—Ç–µ–∂–∞ (Due_Date)**<br>1.¬†**–ü–æ–∏—Å–∫ —Ñ–∞–∫—Ç–∞:**¬†–ï—Å–ª–∏ –µ—Å—Ç—å¬†next_payment_date¬†‚Üí –±–µ—Ä–µ–º –µ—ë.<br>2.¬†**Fallback (–≠–≤—Ä–∏—Å—Ç–∏–∫–∞):**¬†–ë–µ—Ä–µ–º –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ (day) –∏–∑¬†start_date.<br>–ï—Å–ª–∏¬†today.day¬†<¬†start_date.day¬†‚Üí¬†Due_Date¬†–≤ —ç—Ç–æ–º –º–µ—Å—è—Ü–µ.<br>–ò–Ω–∞—á–µ ‚Üí¬†Due_Date¬†–≤ —Å–ª–µ–¥—É—é—â–µ–º –º–µ—Å—è—Ü–µ.<br><br>**–≠–¢–ê–ü 3: –†–∞—Å—á–µ—Ç –û—Å—Ç–∞—Ç–∫–∞ –∫ –æ–ø–ª–∞—Ç–µ (Remaining)**<br>1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥¬†paid_in_current_period¬†(–∏–∑ Alg 1).<br>–ï—Å–ª–∏¬†True¬†‚Üí¬†remaining = 0.<br>–ï—Å–ª–∏¬†False¬†‚Üí¬†remaining = Monthly_Payment.<br><br>**–≠–¢–ê–ü 4: –†–∞—Å—á–µ—Ç MDP**<br>1. –î–Ω–µ–π –¥–æ –ø–ª–∞—Ç–µ–∂–∞:¬†days_left = (Due_Date - today).days.<br>–ï—Å–ª–∏¬†days_left <= 0¬†(–¥–µ–Ω—å –ø–ª–∞—Ç–µ–∂–∞ –∏–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–∞) ‚Üí¬†days_left = 1.<br>2. –î–Ω–µ–≤–Ω–æ–π –ø–ª–∞—Ç–µ–∂:¬†daily_mdp = remaining / days_left.<br><br>**–≠–¢–ê–ü 5: –ò—Ç–æ–≥**<br>mdp_today_base¬†= –°—É–º–º–∞¬†daily_mdp¬†–ø–æ –≤—Å–µ–º –∫—Ä–µ–¥–∏—Ç–∞–º (–≤ –ø–µ—Ä–µ—Å—á–µ—Ç–µ –Ω–∞ RUB). |
| adp_calculation | –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç Additional Daily Payments ‚Äî —É—Å–∫–æ—Ä–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏. | **1. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã MDP (mdp_calculation):**<br>‚Ä¢¬†mdp_today_base¬†(–±–∞–∑–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —É—Å–∫–æ—Ä–µ–Ω–∏—è).<br><br>**2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Debt (total_debt):**<br>‚Ä¢¬†active_loans[]: —Å–ø–∏—Å–æ–∫ —Å –ø–æ–ª—è–º–∏¬†id,¬†amount¬†(–æ—Å—Ç–∞—Ç–æ–∫),¬†interest_rate.<br><br>**3. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã Income (categorization):**<br>‚Ä¢¬†estimated_monthly_income¬†(–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏).<br><br>**4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**<br>‚Ä¢¬†repayment_speed¬†(Conservative/Balanced/Fast).<br>‚Ä¢¬†strategy¬†(Avalanche/Snowball). –î–µ—Ñ–æ–ª—Ç = Avalanche. | adp_today_base¬†(–°–∫–æ–ª—å–∫–æ –¥–æ–ø–ª–∞—Ç–∏—Ç—å –≤—Å–µ–≥–æ).<br>‚Ä¢¬†target_loan_id¬†(ID –∫—Ä–µ–¥–∏—Ç–∞, –∫—É–¥–∞ —Å–ª–∞—Ç—å –¥–µ–Ω—å–≥–∏).<br>‚Ä¢¬†target_reason¬†(–ü–æ—á–µ–º—É –≤—ã–±—Ä–∞–Ω —ç—Ç–æ—Ç –∫—Ä–µ–¥–∏—Ç: "Highest Rate" / "Smallest Balance"). | **–≠–¢–ê–ü 1: –†–∞—Å—á–µ—Ç —Å—É–º–º—ã ADP (Budget Calculation)**<br>1.¬†**–û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç:**<br>¬†¬†Conservative: 10% –æ—Ç MDP (k=0.1).<br>¬†¬†Balanced: 30% –æ—Ç MDP (k=0.3).<br>¬†¬†Fast: 50% –æ—Ç MDP (k=0.5).<br>2.¬†**–°—á–∏—Ç–∞–µ–º –±–∞–∑—É:**¬†raw_adp = mdp_today_base * k.<br>3.¬†**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Cap):**<br>¬†(–ß—Ç–æ–±—ã –Ω–µ –æ—Å—Ç–∞–≤–∏—Ç—å —é–∑–µ—Ä–∞ –±–µ–∑ –µ–¥—ã)<br>¬†–ï—Å–ª–∏¬†estimated_monthly_income > 0:<br>¬†max_daily_cap = (Income * 0.2) / 30¬†(–Ω–µ –±–æ–ª–µ–µ 20% –¥–æ—Ö–æ–¥–∞ –Ω–∞ –¥–æ—Å—Ä–æ—á–∫—É).<br>¬†adp_today_base = min(raw_adp, max_daily_cap).<br>¬†–ò–Ω–∞—á–µ (–¥–æ—Ö–æ–¥ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω):<br>¬†adp_today_base = raw_adp.<br><br>**–≠–¢–ê–ü 2: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤ (Strategy Ranking)**<br>–ë–µ—Ä–µ–º —Å–ø–∏—Å–æ–∫¬†active_loans. –°–æ—Ä—Ç–∏—Ä—É–µ–º –µ–≥–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:<br><br>üÖ∞Ô∏è¬†**Avalanche (–õ–∞–≤–∏–Ω–∞) ‚Äî –í—ã–≥–æ–¥–Ω–µ–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏:**<br>¬†1. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ¬†interest_rate¬†(DESC - –æ—Ç –±–æ–ª—å—à–µ–π –∫ –º–µ–Ω—å—à–µ–π).<br>¬†2. –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ —Å—Ç–∞–≤–æ–∫: –ø–æ¬†amount¬†(ASC - –¥–æ–±–∏–≤–∞–µ–º –º–µ–ª–∫–∏–π).<br><br>üÖ±Ô∏è¬†**Snowball (–°–Ω–µ–∂–Ω—ã–π –∫–æ–º) ‚Äî –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ª–µ–≥—á–µ:**<br>¬†1. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ¬†amount¬†(ASC - –æ—Ç –º–µ–Ω—å—à–µ–≥–æ –¥–æ–ª–≥–∞ –∫ –±–æ–ª—å—à–µ–º—É).<br>¬†2. –ü—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ: –ø–æ¬†interest_rate¬†(DESC).<br><br>**–≠–¢–ê–ü 3: –í—ã–±–æ—Ä —Ü–µ–ª–∏ (Target Selection)**<br>1. –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –∫—Ä–µ–¥–∏—Ç –∏–∑ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞:¬†TopLoan.<br>2.¬†target_loan_id = TopLoan.id.<br>3.¬†**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–ø–ª–∞—Ç—ã:**<br>¬†–ï—Å–ª–∏¬†adp_today_base > TopLoan.amount¬†(–æ—Å—Ç–∞—Ç–æ–∫ –¥–æ–ª–≥–∞ –º–µ–Ω—å—à–µ –ø–ª–∞—Ç–µ–∂–∞):<br>¬†¬†adp_today_base = TopLoan.amount¬†(–Ω–µ –ø–ª–∞—Ç–∏–º –±–æ–ª—å—à–µ, —á–µ–º –¥–æ–ª–∂–Ω—ã).<br><br>**–≠–¢–ê–ü 4: –í—ã—Ö–æ–¥**<br>–í–æ–∑–≤—Ä–∞—â–∞–µ–º¬†adp_today_base¬†–∏¬†target_loan_id. |
| sts_calculation | –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç Safe-to-Spend ‚Äî —Å–∫–æ–ª—å–∫–æ –º–æ–∂–Ω–æ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è, –∏—Å—Ö–æ–¥—è –∏–∑ MDP/ADP, –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏, –ø–æ–¥–ø–∏—Å–æ–∫, —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π. | **1. –ö—ç—à (Alg 2):**¬†total_debit_balance_base<br>**2. –î–æ—Ö–æ–¥ (Alg 1):**¬†estimated_monthly_income,¬†type¬†(reg/irreg),¬†next_date.<br>**3. –î–æ–ª–≥–∏ (Alg 4):**¬†active_loans¬†(–¥–∞—Ç–∞ –∏ –ø–æ–ª–Ω–∞—è —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞).<br>**4. –î–æ—Å—Ä–æ—á–∫–∞ (Alg 5):**¬†adp_today_base¬†(—Å—É–º–º–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã —Ä–µ—à–∏–ª–∏ –≤–Ω–µ—Å—Ç–∏ —Å–≤–µ—Ä—Ö –≥—Ä–∞—Ñ–∏–∫–∞).<br>**5. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**¬†Horizon=30,¬†Buffer¬†(—Å—É–º–º–∞). | sts_daily_recommended¬†(–õ–∏–º–∏—Ç –Ω–∞ —Å–µ–≥–æ–¥–Ω—è).<br>‚Ä¢ | **–≠–¢–ê–ü 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**<br>Current_Sim_Balance = total_debit_balance_base<br>Min_Low_Point = total_debit_balance_base<br><br>**–≠–¢–ê–ü 2: –°–∏–º—É–ª—è—Ü–∏—è (Loop 1..30)**<br>–î–ª—è¬†d¬†–æ—Ç 1 –¥–æ 30:<br>1.¬†**–°–ø–∏—Å–∞–Ω–∏—è:**¬†–ï—Å–ª–∏ –Ω–∞ –¥–µ–Ω—å¬†d¬†–≤—ã–ø–∞–¥–∞–µ—Ç¬†Due_Date¬†–∫—Ä–µ–¥–∏—Ç–∞ ‚Üí¬†Current_Sim_Balance -= monthly_payment.<br>2.¬†**–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è:**¬†–ï—Å–ª–∏¬†type == "regular"¬†–ò –¥–µ–Ω—å¬†d¬†—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å¬†next_date¬†‚Üí¬†Current_Sim_Balance += income.¬†(–î–ª—è¬†irregular¬†–¥–æ—Ö–æ–¥ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º).<br>3.¬†**–§–∏–∫—Å–∞—Ü–∏—è –¥–Ω–∞:**¬†Min_Low_Point = min(Min_Low_Point, Current_Sim_Balance).<br><br>**–≠–¢–ê–ü 3: –†–∞—Å—á–µ—Ç "–°–≤–æ–±–æ–¥–Ω—ã—Ö –¥–µ–Ω–µ–≥"**<br>Free_Cash = Min_Low_Point - Safety_Buffer - adp_today_base<br>(–í–∞–∂–Ω–æ: –≤—ã—á–∏—Ç–∞–µ–º ADP, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∏ –¥–µ–Ω—å–≥–∏ —É–∂–µ "–æ–±–µ—â–∞–Ω—ã" –Ω–∞ –¥–æ—Å—Ä–æ—á–Ω–æ–µ –ø–æ–≥–∞—à–µ–Ω–∏–µ).<br><br>**–≠–¢–ê–ü 4: –†–µ–∑—É–ª—å—Ç–∞—Ç**<br>1. –ï—Å–ª–∏¬†Free_Cash < 0¬†‚Üí¬†sts = 0,¬†status = "DANGER".<br>2. –ò–Ω–∞—á–µ:<br>¬†days_div = days_until_next_income¬†(–∏–ª–∏ 30).<br>¬†sts_daily_recommended = Free_Cash / days_div. |
| loan_ranking_engine | –†–∞–Ω–∂–∏—Ä—É–µ—Ç –∫—Ä–µ–¥–∏—Ç—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –ø–æ–≥–∞—à–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MDP, ADP, total_debt, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏). | **1. –°–ø–∏—Å–æ–∫ –¥–æ–ª–≥–æ–≤ (–∏–∑ Total Debt + MDP):**<br>–û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ:<br>‚Ä¢¬†loan_id,¬†amount¬†(–æ—Å—Ç–∞—Ç–æ–∫),¬†interest_rate,¬†product_type.<br>‚Ä¢¬†monthly_payment¬†(–∏–∑ MDP).<br><br>**2. –†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–∑ Catalog):**<br>‚Ä¢¬†catalog_products[]¬†(–¥–ª—è –ø–æ–∏—Å–∫–∞ –ª—É—á—à–µ–π —Å—Ç–∞–≤–∫–∏).<br><br>**3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:**<br>‚Ä¢¬†strategy¬†(Avalanche / Snowball).<br>‚Ä¢¬†refi_threshold¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω–∏—Ü–∞ –≤ 2% —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–≤–æ–¥–æ–º –¥–ª—è —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∞). | ordered_loans[]: —Å–ø–∏—Å–æ–∫ –∫—Ä–µ–¥–∏—Ç–æ–≤, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –ø–æ–≥–∞—à–µ–Ω–∏—è. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–ª–∞–≥–∏:<br>¬†‚Äì¬†priority_rank¬†(1 = –ø–ª–∞—Ç–∏—Ç—å —Å—é–¥–∞ ADP).<br>¬†‚Äì¬†is_refi_candidate¬†(True/False).<br>¬†‚Äì¬†potential_refi_rate¬†(—Å—Ç–∞–≤–∫–∞, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å). | **–≠–¢–ê–ü 1: –û–±–æ–≥–∞—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (Refi Check)**<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞:<br>1. –ù–∞—Ö–æ–¥–∏–º –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (catalog.json) –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Å—Ç–∞–≤–∫—É –¥–ª—è —Ç–∞–∫–æ–≥–æ –∂–µ —Ç–∏–ø–∞ –ø—Ä–æ–¥—É–∫—Ç–∞ (loan¬†vs¬†loan). –ù–∞–∑–æ–≤–µ–º¬†best_market_rate.<br>2. –ï—Å–ª–∏¬†current_rate - best_market_rate >= refi_threshold¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä, 12.9% - 9.3% = 3.6% > 2%):<br>¬†¬†is_refi_candidate = True<br>¬†¬†potential_refi_rate = best_market_rate<br>¬†–ò–Ω–∞—á–µ¬†False.<br><br>**–≠–¢–ê–ü 2: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (Sorting)**<br>–ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Å–ø–∏—Å–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:<br><br>üÖ∞Ô∏è¬†**Avalanche (–í—ã–≥–æ–¥–∞):**<br>1. –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª—é—á:¬†interest_rate¬†(DESC) ‚Äî —Å–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–æ–≥–∏–µ.<br>2. –í—Ç–æ—Ä–∏—á–Ω—ã–π –∫–ª—é—á:¬†amount¬†(ASC) ‚Äî –ø—Ä–∏ —Ä–∞–≤–Ω—ã—Ö —Å—Ç–∞–≤–∫–∞—Ö –¥–æ–±–∏–≤–∞–µ–º –º–µ–ª–∫–∏–π.<br><br>üÖ±Ô∏è¬†**Snowball (–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è):**<br>1. –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª—é—á:¬†amount¬†(ASC) ‚Äî —Å–Ω–∞—á–∞–ª–∞ –º–µ–ª–∫–∏–µ.<br>2. –í—Ç–æ—Ä–∏—á–Ω—ã–π –∫–ª—é—á:¬†interest_rate¬†(DESC).<br><br>(Hybrid –≤—ã–∫–∏–¥—ã–≤–∞–µ–º –¥–ª—è MVP, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –ø—É—Ç–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –õ–∏–±–æ –≤—ã–≥–æ–¥–∞, –ª–∏–±–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è).<br><br>**–≠–¢–ê–ü 3: –ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ä–∞–Ω–≥–æ–≤**<br>–ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É —Å–ø–∏—Å–∫—É:<br>–ò–Ω–¥–µ–∫—Å 0 –ø–æ–ª—É—á–∞–µ—Ç¬†priority_rank = 1¬†(–°—é–¥–∞ –ø–æ–π–¥–µ—Ç –≤–µ—Å—å ADP).<br>–ò–Ω–¥–µ–∫—Å 1 –ø–æ–ª—É—á–∞–µ—Ç¬†priority_rank = 2¬†–∏ —Ç.–¥. |
| financing_need_detector | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω—É–∂–¥–∞–µ—Ç—Å—è –ª–∏ –∫–ª–∏–µ–Ω—Ç –≤ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏ (—Ä–µ—Ñ–∏–Ω–∞–Ω—Å, –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è, —Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è). | **1. –î–æ—Ö–æ–¥—ã (Alg 1):**<br>‚Ä¢¬†estimated_monthly_income¬†(–î–æ—Ö–æ–¥).<br><br>**2. –ù–∞–≥—Ä—É–∑–∫–∞ (Alg 4 MDP):**<br>‚Ä¢¬†active_loans[]: –±–µ—Ä–µ–º –ø–æ–ª–µ¬†Monthly_Payment¬†–ø–æ –∫–∞–∂–¥–æ–º—É –∫—Ä–µ–¥–∏—Ç—É.<br><br>**3. –§–∏–Ω–∞–Ω—Å–æ–≤–æ–µ –∑–¥–æ—Ä–æ–≤—å–µ (Alg 5 STS):**<br>‚Ä¢¬†sts_status¬†(OK¬†/¬†DANGER).<br>‚Ä¢¬†days_until_gap¬†(–¥–Ω–µ–π –¥–æ –º–∏–Ω—É—Å–∞).<br><br>**4. –ö–∞—á–µ—Å—Ç–≤–æ –¥–æ–ª–≥–æ–≤ (Alg 6 Ranking):**<br>‚Ä¢¬†ordered_loans[]: –±–µ—Ä–µ–º —Ñ–ª–∞–≥¬†is_refi_candidate¬†–∏¬†potential_refi_rate.<br><br>**5. –ü—Ä–æ—Å—Ä–æ—á–∫–∞ (Alg 3 Total Debt):**<br>‚Ä¢¬†total_overdue_debt_base¬†(—Å—É–º–º–∞ –ø—Ä–æ—Å—Ä–æ—á–∫–∏).<br><br>**6. –ö–æ–Ω—Ñ–∏–≥:**<br>‚Ä¢¬†DTI_Threshold¬†(–Ω–∞–ø—Ä. 0.5 ‚Äî 50% –¥–æ—Ö–æ–¥–∞ —É—Ö–æ–¥–∏—Ç –Ω–∞ –¥–æ–ª–≥–∏). | financing_needed¬†(Bool).<br>‚Ä¢¬†urgency¬†(None,¬†Watch,¬†Medium,¬†High).<br>‚Ä¢¬†triggers[]¬†(—Å–ø–∏—Å–æ–∫ —Å—Ä–∞–±–æ—Ç–∞–≤—à–∏—Ö —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤).<br>‚Ä¢¬†refi_candidates[]¬†(—Å–ø–∏—Å–æ–∫ ID –∫—Ä–µ–¥–∏—Ç–æ–≤ –¥–ª—è —Ä–µ—Ñ–∏–Ω–∞–Ω—Å–∞). | **–≠–¢–ê–ü 1: –†–∞—Å—á–µ—Ç –ü–î–ù (DTI)**<br>1.¬†Total_Payments = SUM(loan.Monthly_Payment)¬†–ø–æ –≤—Å–µ–º –∞–∫—Ç–∏–≤–Ω—ã–º –∫—Ä–µ–¥–∏—Ç–∞–º.<br>2. –ï—Å–ª–∏¬†Income > 0:<br>¬†DTI = Total_Payments / Income.<br>¬†–ò–Ω–∞—á–µ (–¥–æ—Ö–æ–¥ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω):¬†DTI = 1.0¬†(–°—á–∏—Ç–∞–µ–º, —á—Ç–æ –≤—Å—ë –ø–ª–æ—Ö–æ).<br><br>**–≠–¢–ê–ü 2: –°–±–æ—Ä —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ (Trigger Collection)**<br>–ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å–ª–æ–≤–∏—è –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫¬†triggers:¬†<br>1.¬†**Overdue:**¬†–ï—Å–ª–∏¬†total_overdue_debt_base > 0¬†‚Üí add¬†"overdue".<br>2.¬†**Gap Risk:**¬†–ï—Å–ª–∏¬†sts_status == "DANGER"¬†‚Üí add¬†"gap_risk".<br>3.¬†**High Load:**¬†–ï—Å–ª–∏¬†DTI > DTI_Threshold¬†‚Üí add¬†"high_dti".<br>4.¬†**Refi Opportunity:**¬†–ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ¬†ordered_loans. –ï—Å–ª–∏¬†is_refi_candidate == True¬†–∏ –ø—Ä–∏ —ç—Ç–æ–º¬†total_overdue_debt_base == 0¬†(–±–µ–∑ –ø—Ä–æ—Å—Ä–æ—á–µ–∫!) ‚Üí add¬†"refi_opportunity"¬†–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º ID –∫—Ä–µ–¥–∏—Ç–∞ –≤¬†refi_candidates[].<br><br>**–≠–¢–ê–ü 3: –û—Ü–µ–Ω–∫–∞ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏ (Urgency Matrix)**<br>¬†**HIGH:**¬†–ï—Å–ª–∏ –µ—Å—Ç—å¬†"overdue"¬†–ò–õ–ò¬†"gap_risk"¬†(–¥–µ–Ω–µ–≥ –Ω–µ—Ç –∏–ª–∏ —É–∂–µ –¥–æ–ª–∂–Ω—ã).<br>¬†**MEDIUM:**¬†–ï—Å–ª–∏ –µ—Å—Ç—å¬†"high_dti"¬†(–¥–µ–Ω–µ–≥ –ø–æ–∫–∞ —Ö–≤–∞—Ç–∞–µ—Ç, –Ω–æ –Ω–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª—å—à–∞—è).<br>¬†**WATCH:**¬†–ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ¬†"refi_opportunity"¬†(–≤—Å—ë —Ö–æ—Ä–æ—à–æ, –Ω–æ –º–æ–∂–Ω–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å).<br>¬†**NONE:**¬†–ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –ø—É—Å—Ç.<br><br>**–≠–¢–ê–ü 4: –§–∏–Ω–∞–ª**<br>financing_needed = (urgency != "None"). |
| best_financing_offer_selector | –ü–æ–¥–±–∏—Ä–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞–∏–±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è: —Ä–µ—Ñ–∏–Ω–∞–Ω—Å, –∫–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è. | **1. –¢–µ–∫—É—â–∏–µ –¥–æ–ª–≥–∏ (–∏–∑ Alg 7 Detector):**<br>‚Ä¢¬†refi_candidates[]: —Å–ø–∏—Å–æ–∫ ID –∫—Ä–µ–¥–∏—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –≥–∞—Å–∏—Ç—å.<br>‚Ä¢ –î–µ—Ç–∞–ª–∏ –∏–∑¬†active_loans¬†(amount,¬†rate,¬†Monthly_Payment¬†–∏–∑ MDP).<br><br>**2. –ö–∞—Ç–∞–ª–æ–≥ –æ—Ñ—Ñ–µ—Ä–æ–≤ (Catalog):**<br>‚Ä¢¬†offers[]:¬†{id, type, rate, min_amount, max_amount, max_term_months}.<br><br>**3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**<br>‚Ä¢¬†income¬†(–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –æ—Ñ—Ñ–µ—Ä–∞).<br>‚Ä¢¬†min_rate_diff¬†(–Ω–∞–ø—Ä–∏–º–µ—Ä, 1.5% ‚Äî –ø–æ—Ä–æ–≥ —Å–º—ã—Å–ª–∞). | top_offers[]¬†‚Äî —Å–ø–∏—Å–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.<br>–ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç:<br>‚Ä¢¬†offer_data¬†(—Å–∞–º –æ—Ñ—Ñ–µ—Ä).<br>‚Ä¢¬†strategy¬†("Refinance One" / "Consolidation").<br>‚Ä¢¬†old_monthly_payment¬†(–±—ã–ª–æ).<br>‚Ä¢¬†new_monthly_payment¬†(—Å—Ç–∞–Ω–µ—Ç).<br>‚Ä¢¬†monthly_saving¬†(–≤—ã–≥–æ–¥–∞ –≤ –º–µ—Å—è—Ü). | **–≠–¢–ê–ü 1: –°—Ü–µ–Ω–∞—Ä–∏–π "–¢–æ—á–µ—á–Ω—ã–π –≤—ã—Å—Ç—Ä–µ–ª" (Single Refi)**<br>–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞ –∏–∑¬†refi_candidates:<br>1. –ò—â–µ–º –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –æ—Ñ—Ñ–µ—Ä—ã —Ç–∏–ø–∞¬†refinance, –≥–¥–µ:<br>¬†¬†offer.min_amount <= loan.amount <= offer.max_amount.<br>¬†¬†offer.rate <= loan.rate - min_rate_diff¬†(–í—ã–≥–æ–¥–∞ –ø–æ —Å—Ç–∞–≤–∫–µ).<br>2. –ï—Å–ª–∏ –Ω–∞—à–ª–∏, —Å—á–∏—Ç–∞–µ–º –Ω–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ (Annuity):<br>¬†New_Payment = PMT(offer.rate, offer.max_term, loan.amount).<br>¬†(–ë–µ—Ä–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –æ—Ñ—Ñ–µ—Ä–∞, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–π –ø–ª–∞—Ç–µ–∂ ‚Äî —ç—Ç–æ –ø—Ä–æ–¥–∞—é—â–∞—è —Ñ–∏—à–∫–∞).<br>3. –°—á–∏—Ç–∞–µ–º –≤—ã–≥–æ–¥—É:<br>¬†Saving = loan.Monthly_Payment - New_Payment.<br>4. –ï—Å–ª–∏¬†Saving > 0, –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.<br><br>**–≠–¢–ê–ü 2: –°—Ü–µ–Ω–∞—Ä–∏–π "–ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è" (All-in)**<br>1. –°–æ–±–∏—Ä–∞–µ–º ¬´–ü–∞–∫–µ—Ç¬ª: –°—É–º–º–∏—Ä—É–µ–º¬†amount¬†–∏¬†Monthly_Payment¬†–≤—Å–µ—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤ –∏–∑¬†refi_candidates. –ü–æ–ª—É—á–∞–µ–º¬†Total_Debt_Sum¬†–∏¬†Total_Current_Pay.<br>2. –ò—â–µ–º –æ—Ñ—Ñ–µ—Ä—ã —Ç–∏–ø–∞¬†refinance¬†/¬†consolidation¬†/¬†loan, –≥–¥–µ:<br>¬†¬†offer.max_amount >= Total_Debt_Sum.<br>3. –°—á–∏—Ç–∞–µ–º –Ω–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –¥–ª—è –ü–∞–∫–µ—Ç–∞:<br>¬†New_Total_Pay = PMT(offer.rate, offer.max_term, Total_Debt_Sum).<br>4. –°—á–∏—Ç–∞–µ–º –≤—ã–≥–æ–¥—É:<br>¬†Total_Saving = Total_Current_Pay - New_Total_Pay.<br>5. –ï—Å–ª–∏¬†Total_Saving > 0, –¥–æ–±–∞–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–æ–∫.<br><br>**–≠–¢–ê–ü 3: –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ –í—ã–±–æ—Ä**<br>1. –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–∞–ø–æ–≤ 1 –∏ 2.<br>2. –°–æ—Ä—Ç–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ¬†monthly_saving¬†(DESC). –ß–µ–º –±–æ–ª—å—à–µ –¥–µ–Ω–µ–≥ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∫–∞—Ä–º–∞–Ω–µ, —Ç–µ–º –≤—ã—à–µ –æ—Ñ—Ñ–µ—Ä.<br>3. –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ø-3. |